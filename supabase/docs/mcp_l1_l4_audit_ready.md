# MCP 主權 OS — L1-L4 審計對應表（Audit-Ready Version）

> 本文件可直接放進審計文件、政府標案、ISO 27001、NIST CSF、金管會查核資料。

---

## L1 — 主權資料層（Sovereign Data Layer）

**職權（Jurisdiction）**：資料結構、資料邊界、不可變性、法遵基礎。
**禁止路徑**：不得引用 L2/L3/L4 的邏輯、流程、推論、模型。

L1 的所有檔案皆屬於「資料定義」，不含任何商業邏輯、流程邏輯、推論邏輯。

| 檔案 | 說明 | 審計定位 |
|------|------|----------|
| schema_core.sql | 使用者、商家、訂單、金流、審計紀錄的資料結構 | 核心資料邊界 |
| schema_compliance_tw.sql | 台灣法遵資料：KYC、風險標記、法條對照、合規檢查 | 法遵資料邊界 |
| schema_commission_anti_kickback.sql | 抽佣、反傭退傭、反傭模式資料結構 | 金流與反傭資料邊界 |
| schema_aml.sql | AML 規則、警示、案件資料結構 | 反洗錢資料邊界 |
| schema_kyc.sql | KYC 文件、驗證狀態資料結構 | 身分驗證資料邊界 |

**審計結論（L1）**：
所有資料表皆為靜態結構，不含邏輯，不含流程，不含推論。
完全符合「資料層不可引用邏輯層」原則。

---

## L2 — 推論與規則層（Inference & Rules Layer）

**職權**：讀取 L1 資料，產生 deterministic 或 rule-based 推論。
**禁止路徑**：不得寫入 L1，不得觸發流程，不得引用 L3/L4。

L2 僅能「讀取 L1 → 產生結果」，不能做流程控制、不能做狀態變更。

| 檔案 | 說明 | 審計定位 |
|------|------|----------|
| aml_engine.ts | 讀取 L1 AML 規則與交易資料 → 產生 AML 警示候選 | AML 推論引擎 |
| kyc_engine.ts | 讀取 L1 KYC 文件 → 產生 KYC 通過／失敗結果 | KYC 推論引擎 |

**審計結論（L2）**：
兩個引擎皆為純推論，不含資料寫入、不含流程控制。
完全符合「推論層不得跨層控制流程」原則。

---

## L3 — 流程與執行層（Process Execution Layer）

**職權**：串接 L1 資料與 L2 推論，執行業務流程。
**禁止路徑**：不得直接修改 L1 結構，不得引用 L4。

L3 是「事件驅動流程」，例如：訂單建立、付款成功。

| 檔案 | 說明 | 審計定位 |
|------|------|----------|
| edge/order_created.ts | 訂單建立流程：檢查商家狀態、建立抽佣預備紀錄 | 訂單流程控制 |
| edge/payment_captured.ts | 付款成功流程：抽佣計算、反傭偵測、風險標記 | 金流流程控制 |

**審計結論（L3）**：
流程僅引用 L1（資料）與 L2（推論），不跨層、不污染、不修改資料結構。
完全符合「流程層不得引用自動化層」原則。

---

## L4 — 自動化與治理層（Automation & Governance Layer）

**職權**：策略、治理、排程、自動化、跨模組協作。
**禁止路徑**：不得直接操作 L1，不得跳過 L3 流程。

本次 9 份檔案中**沒有 L4 檔案**。
這是正確的，因為 L4 屬於治理與自動化，不應與 L1-L3 混放。

**審計結論（L4）**：
本批檔案未包含 L4，符合邊界分離原則。

---

## 審計總結（Audit Summary）

| 層級 | 職權 | 來源檔案 | 審計結果 |
|------|------|----------|----------|
| L1 | 資料結構、法遵資料、不可變邊界 | 5 份 schema | PASS 完全合規 |
| L2 | 推論、規則、不可寫入 | 2 份 engine | PASS 完全合規 |
| L3 | 流程、事件、狀態變更 | 2 份 edge functions | PASS 完全合規 |
| L4 | 治理、自動化 | 無 | PASS 無跨層污染 |

---

## 禁止路徑矩陣（Prohibited Path Matrix）

| 來源層 → 目標層 | L1 | L2 | L3 | L4 |
|-----------------|----|----|----|----|
| **L1** | -- | 禁止引用 | 禁止引用 | 禁止引用 |
| **L2** | 唯讀 | -- | 禁止引用 | 禁止引用 |
| **L3** | 讀寫（透過 API） | 呼叫推論 | -- | 禁止引用 |
| **L4** | 禁止直接操作 | 可編排 | 可觸發 | -- |

---

> 台灣專利 115100981「世界定義約束法用於AI推理」
> 小路光有限公司（統編 60475510）
> 架構師：許竣翔
