-- 修復 function_search_path_mutable（排除受 GOVERNMENT LOCKDOWN 保護的函數）
-- 防止 schema injection 攻擊，所有業務函數設定 SET search_path = ''
ALTER FUNCTION public.absorb_external_data() SET search_path = '';
ALTER FUNCTION public.add_user(email text) SET search_path = '';
ALTER FUNCTION public.auto_whip_sloth_units() SET search_path = '';
ALTER FUNCTION public.call_opus_gpu(user_id integer, model_mode text) SET search_path = '';
ALTER FUNCTION public.check_ai_output_safety(p_ai_response text) SET search_path = '';
ALTER FUNCTION public.check_and_activate_shadow_pilot(p_user_id uuid) SET search_path = '';
ALTER FUNCTION public.check_kill_switch(p_model_id text) SET search_path = '';
ALTER FUNCTION public.check_thought_resonance(user_thought vector) SET search_path = '';
ALTER FUNCTION public.check_timeline_integrity() SET search_path = '';
ALTER FUNCTION public.check_usage_low() SET search_path = '';
ALTER FUNCTION public.collapse_wavefunction(p_sim_id uuid) SET search_path = '';
ALTER FUNCTION public.commander_purge_sloths() SET search_path = '';
ALTER FUNCTION public.decompose_strategy_into_tasks() SET search_path = '';
ALTER FUNCTION public.fast_log_audit(p_model_id text, p_score double precision) SET search_path = '';
ALTER FUNCTION public.firewall_input_prompt(p_user_input text) SET search_path = '';
ALTER FUNCTION public.generate_ai_law_report() SET search_path = '';
ALTER FUNCTION public.get_db_health() SET search_path = '';
ALTER FUNCTION public.get_index_counts() SET search_path = '';
ALTER FUNCTION public.get_table_sizes() SET search_path = '';
ALTER FUNCTION public.get_user_recommendations(user_id integer) SET search_path = '';
ALTER FUNCTION public.get_user_recommendations_brutal(user_id integer) SET search_path = '';
ALTER FUNCTION public.get_user_recommendations_enhanced(user_id integer) SET search_path = '';
ALTER FUNCTION public.get_user_recommendations_insane(user_id uuid) SET search_path = '';
ALTER FUNCTION public.get_user_recommendations_insane_v3(user_id uuid) SET search_path = '';
ALTER FUNCTION public.global_compliance_monitor() SET search_path = '';
ALTER FUNCTION public.hash_ip_on_insert() SET search_path = '';
ALTER FUNCTION public.inspect_execution_integrity(p_topic text, p_content text) SET search_path = '';
ALTER FUNCTION public.lock_wallet_during_autopilot() SET search_path = '';
ALTER FUNCTION public.log_business_items_changes() SET search_path = '';
ALTER FUNCTION public.marketplace_purchase_with_split(p_listing_id uuid, p_buyer_id uuid, p_buyer_email text, p_referral_code text) SET search_path = '';
ALTER FUNCTION public.notify_boss_event() SET search_path = '';
ALTER FUNCTION public.orchestrate_war_room() SET search_path = '';
ALTER FUNCTION public.process_mission_feedback(p_agent_id text, p_success boolean, p_score integer, p_feedback_text text) SET search_path = '';
ALTER FUNCTION public.review_objective_progress() SET search_path = '';
ALTER FUNCTION public.route_rocket_to_user(p_user_id uuid, p_query_topic text) SET search_path = '';
ALTER FUNCTION public.run_deep_defense_scan() SET search_path = '';
ALTER FUNCTION public.run_tps_benchmark(duration_seconds integer) SET search_path = '';
ALTER FUNCTION public.run_tps_benchmark_turbo(duration_seconds integer) SET search_path = '';
ALTER FUNCTION public.sanitize_pii_data() SET search_path = '';
ALTER FUNCTION public.scan_for_bias(content text) SET search_path = '';
ALTER FUNCTION public.scan_high_risk_compliance() SET search_path = '';
ALTER FUNCTION public.scan_privacy_leak(content text) SET search_path = '';
ALTER FUNCTION public.simulate_attack_wave(batch_size integer) SET search_path = '';
ALTER FUNCTION public.simulate_tomorrow() SET search_path = '';
ALTER FUNCTION public.summon_virtual_commander(event_context jsonb) SET search_path = '';
ALTER FUNCTION public.update_baq_updated_at() SET search_path = '';
ALTER FUNCTION public.update_user_interests_daily() SET search_path = '';
ALTER FUNCTION public.weekly_agent_review() SET search_path = '';
