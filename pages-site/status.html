<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>指揮中心 — SEOBAIKE</title>
  <meta name="description" content="SEOBAIKE 創辦人指揮中心 — 即時系統監控、營收追蹤、異常偵測。">
  <meta property="og:title" content="指揮中心 — SEOBAIKE">
  <meta property="og:description" content="創辦人專屬指揮中心，即時監控所有系統。">
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://aiforseo.vip/status">
  <meta property="og:image" content="/og-image.png">
  <meta property="og:site_name" content="SEOBAIKE">
  <meta property="og:locale" content="zh_TW">
  <meta name="theme-color" content="#e8850c">
  <link rel="icon" href="/favicon.svg" type="image/svg+xml">
  <link rel="apple-touch-icon" href="/favicon.svg">
  <link rel="manifest" href="/manifest.json">
  <style>
    *, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }

    :root {
      --orange: #e8850c;
      --orange-hover: #d4780a;
      --orange-light: #f5a623;
      --orange-glow: rgba(232, 133, 12, 0.15);
      --orange-glow-strong: rgba(232, 133, 12, 0.25);
      --copper: #cc785c;
      --bg: #0a0a1a;
      --bg-card: rgba(18, 18, 42, 0.7);
      --bg-card-solid: #12122a;
      --bg-warm: rgba(232, 133, 12, 0.03);
      --border: rgba(42, 42, 74, 0.6);
      --border-light: #3a3a5a;
      --text: #e0e0e8;
      --text-muted: #8888aa;
      --text-bright: #ffffff;
      --radius: 16px;
      --green: #28c840;
      --yellow: #febc2e;
      --red: #ff5f57;
    }

    html { scroll-behavior: smooth; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Noto Sans TC", sans-serif;
      background: var(--bg);
      color: var(--text);
      line-height: 1.6;
      overflow-x: hidden;
      min-height: 100vh;
    }

    a { color: var(--orange); text-decoration: none; transition: color 0.2s; }
    a:hover { color: var(--copper); }

    /* ========== Access Gate ========== */
    .access-gate {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: var(--bg);
      z-index: 9999;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      gap: 20px;
      padding: 24px;
    }
    .access-gate.hidden { display: none; }
    .access-gate-logo {
      font-size: 2.4rem;
      font-weight: 900;
      letter-spacing: -1px;
      color: #fff;
      margin-bottom: 8px;
    }
    .access-gate-logo span { color: var(--orange); }
    .access-gate h2 {
      font-size: 1.6rem;
      font-weight: 800;
      color: var(--text-bright);
    }
    .access-gate p {
      color: var(--text-muted);
      font-size: 0.95rem;
      margin-bottom: 8px;
    }
    .access-gate input {
      padding: 14px 24px;
      font-size: 1rem;
      border: 1px solid var(--border);
      border-radius: 12px;
      background: var(--bg-card-solid);
      color: var(--text-bright);
      width: 320px;
      max-width: 100%;
      text-align: center;
      outline: none;
      transition: border-color 0.3s;
    }
    .access-gate input:focus { border-color: var(--orange); }
    .access-gate button {
      padding: 14px 40px;
      font-size: 1rem;
      font-weight: 700;
      border: none;
      border-radius: 12px;
      background: var(--orange);
      color: #fff;
      cursor: pointer;
      transition: background 0.2s, transform 0.2s;
    }
    .access-gate button:hover { background: var(--orange-hover); transform: translateY(-2px); }
    .access-gate .error-msg {
      color: var(--red);
      font-size: 0.88rem;
      min-height: 1.4em;
    }
    .lock-icon {
      width: 64px;
      height: 64px;
      border-radius: 50%;
      background: rgba(232, 133, 12, 0.1);
      border: 2px solid rgba(232, 133, 12, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 1.8rem;
      margin-bottom: 8px;
    }

    /* ========== Main Dashboard ========== */
    #mainContent { display: none; }

    .dashboard-header {
      padding: 20px 32px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      border-bottom: 1px solid var(--border);
      background: rgba(10, 10, 26, 0.9);
      backdrop-filter: blur(20px);
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .header-left {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .header-logo {
      font-size: 1.3rem;
      font-weight: 900;
      color: #fff;
      letter-spacing: -0.5px;
    }
    .header-logo span { color: var(--orange); }
    .header-title {
      font-size: 1.1rem;
      font-weight: 700;
      color: var(--text-muted);
      padding-left: 16px;
      border-left: 1px solid var(--border);
    }
    .header-right {
      display: flex;
      align-items: center;
      gap: 16px;
    }
    .live-badge {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 6px 14px;
      background: rgba(40, 200, 64, 0.1);
      border: 1px solid rgba(40, 200, 64, 0.3);
      border-radius: 20px;
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--green);
    }
    .live-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: var(--green);
      animation: livePulse 1.5s ease-in-out infinite;
    }
    @keyframes livePulse {
      0%, 100% { opacity: 1; box-shadow: 0 0 0 0 rgba(40, 200, 64, 0.5); }
      50% { opacity: 0.6; box-shadow: 0 0 0 6px rgba(40, 200, 64, 0); }
    }
    .refresh-badge {
      font-size: 0.78rem;
      color: var(--text-muted);
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .refresh-badge .countdown {
      color: var(--orange);
      font-weight: 700;
      font-variant-numeric: tabular-nums;
    }
    .btn-logout {
      padding: 6px 14px;
      font-size: 0.8rem;
      font-weight: 600;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: transparent;
      color: var(--text-muted);
      cursor: pointer;
      transition: all 0.2s;
    }
    .btn-logout:hover {
      border-color: var(--red);
      color: var(--red);
    }

    /* ========== Dashboard Grid ========== */
    .dashboard-body {
      max-width: 1400px;
      margin: 0 auto;
      padding: 24px;
    }
    .section-title {
      font-size: 1.1rem;
      font-weight: 800;
      color: var(--text-bright);
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    .section-title .icon {
      width: 28px;
      height: 28px;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.9rem;
    }
    .section-title .icon.health { background: rgba(40, 200, 64, 0.15); }
    .section-title .icon.revenue { background: rgba(232, 133, 12, 0.15); }
    .section-title .icon.users { background: rgba(88, 130, 255, 0.15); }
    .section-title .icon.alert { background: rgba(255, 95, 87, 0.15); }
    .section-title .icon.market { background: rgba(172, 130, 255, 0.15); }

    /* Glass card */
    .glass-card {
      background: var(--bg-card);
      backdrop-filter: blur(20px);
      border: 1px solid var(--border);
      border-radius: var(--radius);
      padding: 24px;
      transition: border-color 0.3s, transform 0.2s;
    }
    .glass-card:hover {
      border-color: var(--border-light);
    }

    .section-block {
      margin-bottom: 32px;
    }

    /* ======================== */
    /* SECTION 1: SYSTEM HEALTH */
    /* ======================== */
    .health-top {
      display: grid;
      grid-template-columns: 1fr 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }

    /* Circular Gauge */
    .gauge-card {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 12px;
    }
    .gauge-wrap {
      position: relative;
      width: 140px;
      height: 140px;
    }
    .gauge-svg {
      width: 140px;
      height: 140px;
      transform: rotate(-90deg);
    }
    .gauge-bg {
      fill: none;
      stroke: rgba(255, 255, 255, 0.06);
      stroke-width: 10;
    }
    .gauge-fill {
      fill: none;
      stroke-width: 10;
      stroke-linecap: round;
      transition: stroke-dashoffset 1.5s ease, stroke 0.5s;
    }
    .gauge-center {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      text-align: center;
    }
    .gauge-value {
      font-size: 1.8rem;
      font-weight: 900;
      color: var(--text-bright);
      line-height: 1;
    }
    .gauge-unit {
      font-size: 0.7rem;
      color: var(--text-muted);
      margin-top: 2px;
    }
    .gauge-label {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--text-muted);
    }

    /* Engine dots */
    .engine-dots-card {
      margin-bottom: 20px;
    }
    .engine-dots-row {
      display: flex;
      gap: 10px;
      justify-content: center;
      align-items: center;
      flex-wrap: wrap;
      padding: 8px 0;
    }
    .engine-dot {
      width: 18px;
      height: 18px;
      border-radius: 50%;
      transition: all 0.4s;
      cursor: default;
      position: relative;
    }
    .engine-dot.online {
      background: var(--green);
      box-shadow: 0 0 10px rgba(40, 200, 64, 0.5);
    }
    .engine-dot.degraded {
      background: var(--yellow);
      box-shadow: 0 0 10px rgba(254, 188, 46, 0.5);
    }
    .engine-dot.offline {
      background: var(--red);
      box-shadow: 0 0 10px rgba(255, 95, 87, 0.5);
      animation: dotPulseRed 1.5s ease-in-out infinite;
    }
    @keyframes dotPulseRed {
      0%, 100% { box-shadow: 0 0 10px rgba(255, 95, 87, 0.5); }
      50% { box-shadow: 0 0 20px rgba(255, 95, 87, 0.8); }
    }
    .engine-dot::after {
      content: attr(data-tip);
      position: absolute;
      bottom: calc(100% + 8px);
      left: 50%;
      transform: translateX(-50%);
      background: var(--bg-card-solid);
      border: 1px solid var(--border-light);
      color: var(--text);
      font-size: 0.72rem;
      padding: 4px 10px;
      border-radius: 6px;
      white-space: nowrap;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.2s;
      z-index: 10;
    }
    .engine-dot:hover::after { opacity: 1; }

    .dots-legend {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin-top: 12px;
      font-size: 0.78rem;
      color: var(--text-muted);
    }
    .dots-legend-item {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .dots-legend-color {
      width: 10px;
      height: 10px;
      border-radius: 50%;
    }

    .timestamp-bar {
      text-align: center;
      font-size: 0.78rem;
      color: var(--text-muted);
      margin-top: 8px;
    }

    /* ==================== */
    /* SECTION 2: REVENUE   */
    /* ==================== */
    .revenue-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
      margin-bottom: 20px;
    }
    .revenue-big {
      display: flex;
      flex-direction: column;
      justify-content: center;
    }
    .revenue-label {
      font-size: 0.85rem;
      color: var(--text-muted);
      font-weight: 500;
      margin-bottom: 4px;
    }
    .revenue-number {
      font-size: 2.8rem;
      font-weight: 900;
      color: var(--orange);
      line-height: 1.1;
      font-variant-numeric: tabular-nums;
    }
    .revenue-number .currency {
      font-size: 1.4rem;
      color: var(--text-muted);
      font-weight: 600;
    }
    .revenue-sub {
      font-size: 0.82rem;
      color: var(--text-muted);
      margin-top: 4px;
    }
    .revenue-sub .up { color: var(--green); font-weight: 700; }

    /* 7 day bar chart */
    .bar-chart {
      display: flex;
      align-items: flex-end;
      gap: 8px;
      height: 120px;
      padding: 8px 0;
    }
    .bar-col {
      flex: 1;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 6px;
      height: 100%;
      justify-content: flex-end;
    }
    .bar-fill {
      width: 100%;
      max-width: 40px;
      border-radius: 6px 6px 2px 2px;
      background: linear-gradient(180deg, var(--orange), rgba(232, 133, 12, 0.4));
      transition: height 1s ease;
      position: relative;
    }
    .bar-fill:hover { opacity: 0.85; }
    .bar-fill::after {
      content: attr(data-val);
      position: absolute;
      top: -20px;
      left: 50%;
      transform: translateX(-50%);
      font-size: 0.65rem;
      color: var(--text-muted);
      font-weight: 600;
      white-space: nowrap;
      opacity: 0;
      transition: opacity 0.2s;
    }
    .bar-fill:hover::after { opacity: 1; }
    .bar-label {
      font-size: 0.7rem;
      color: var(--text-muted);
    }

    /* Top sellers table */
    .sellers-table {
      width: 100%;
      border-collapse: collapse;
    }
    .sellers-table th {
      text-align: left;
      font-size: 0.75rem;
      color: var(--text-muted);
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      padding: 8px 0;
      border-bottom: 1px solid var(--border);
    }
    .sellers-table td {
      padding: 10px 0;
      font-size: 0.88rem;
      border-bottom: 1px solid rgba(42, 42, 74, 0.3);
    }
    .sellers-table tr:last-child td { border-bottom: none; }
    .rank-badge {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      width: 24px;
      height: 24px;
      border-radius: 6px;
      font-size: 0.75rem;
      font-weight: 800;
      color: #fff;
    }
    .rank-badge.r1 { background: linear-gradient(135deg, #FFD700, #e8850c); }
    .rank-badge.r2 { background: linear-gradient(135deg, #C0C0C0, #888); }
    .rank-badge.r3 { background: linear-gradient(135deg, #cd7f32, #a0522d); }
    .rank-badge.r4, .rank-badge.r5 { background: var(--border-light); }
    .seller-amount {
      color: var(--orange);
      font-weight: 700;
      font-variant-numeric: tabular-nums;
    }

    /* ========================= */
    /* SECTION 3: USER ACTIVITY  */
    /* ========================= */
    .users-stats-row {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin-bottom: 20px;
    }
    .user-stat-card {
      text-align: center;
      padding: 20px;
    }
    .user-stat-num {
      font-size: 2rem;
      font-weight: 900;
      color: var(--text-bright);
      font-variant-numeric: tabular-nums;
    }
    .user-stat-label {
      font-size: 0.82rem;
      color: var(--text-muted);
      margin-top: 4px;
    }

    .users-detail-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    /* Recent signups */
    .signup-list {
      list-style: none;
      max-height: 300px;
      overflow-y: auto;
    }
    .signup-list li {
      display: flex;
      align-items: center;
      gap: 10px;
      padding: 8px 0;
      border-bottom: 1px solid rgba(42, 42, 74, 0.3);
      font-size: 0.85rem;
    }
    .signup-list li:last-child { border-bottom: none; }
    .signup-avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      background: var(--orange-glow);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.75rem;
      font-weight: 700;
      color: var(--orange);
      flex-shrink: 0;
    }
    .signup-info { flex: 1; }
    .signup-name { color: var(--text-bright); font-weight: 600; font-size: 0.85rem; }
    .signup-time { color: var(--text-muted); font-size: 0.72rem; }

    /* Country traffic bars */
    .country-list { list-style: none; }
    .country-item {
      display: grid;
      grid-template-columns: 80px 1fr 60px;
      align-items: center;
      gap: 12px;
      padding: 10px 0;
    }
    .country-name {
      font-size: 0.88rem;
      color: var(--text-bright);
      font-weight: 600;
    }
    .country-bar-wrap {
      height: 10px;
      background: rgba(255, 255, 255, 0.05);
      border-radius: 5px;
      overflow: hidden;
    }
    .country-bar-fill {
      height: 100%;
      border-radius: 5px;
      transition: width 1.5s ease;
    }
    .country-pct {
      font-size: 0.82rem;
      color: var(--text-muted);
      text-align: right;
      font-weight: 600;
      font-variant-numeric: tabular-nums;
    }

    /* ================================ */
    /* SECTION 4: CHEATER DETECTION     */
    /* ================================ */
    .alert-grid {
      display: flex;
      flex-direction: column;
      gap: 12px;
    }
    .alert-card {
      display: grid;
      grid-template-columns: 6px 1fr auto;
      gap: 16px;
      padding: 16px 20px;
      border-radius: 12px;
      background: var(--bg-card);
      border: 1px solid var(--border);
      transition: transform 0.2s, border-color 0.3s;
    }
    .alert-card:hover {
      transform: translateX(4px);
      border-color: var(--border-light);
    }
    .alert-severity {
      width: 6px;
      border-radius: 3px;
      align-self: stretch;
    }
    .alert-severity.critical { background: var(--red); box-shadow: 0 0 8px rgba(255, 95, 87, 0.4); }
    .alert-severity.warning { background: var(--yellow); box-shadow: 0 0 8px rgba(254, 188, 46, 0.4); }
    .alert-severity.info { background: var(--green); box-shadow: 0 0 8px rgba(40, 200, 64, 0.4); }
    .alert-body {}
    .alert-title {
      font-weight: 700;
      color: var(--text-bright);
      font-size: 0.92rem;
      margin-bottom: 4px;
    }
    .alert-desc {
      font-size: 0.82rem;
      color: var(--text-muted);
      line-height: 1.5;
    }
    .alert-time {
      font-size: 0.72rem;
      color: var(--text-muted);
      margin-top: 6px;
    }
    .alert-actions {
      display: flex;
      align-items: center;
    }
    .btn-handle {
      padding: 8px 16px;
      font-size: 0.78rem;
      font-weight: 700;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: transparent;
      color: var(--text);
      cursor: pointer;
      transition: all 0.2s;
      white-space: nowrap;
    }
    .btn-handle:hover {
      border-color: var(--orange);
      color: var(--orange);
      background: rgba(232, 133, 12, 0.08);
    }

    /* ============================== */
    /* SECTION 5: MARKETPLACE STATS   */
    /* ============================== */
    .market-top-row {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 16px;
      margin-bottom: 20px;
    }
    .market-stat {
      text-align: center;
      padding: 20px;
    }
    .market-stat-num {
      font-size: 1.8rem;
      font-weight: 900;
      color: var(--text-bright);
    }
    .market-stat-label {
      font-size: 0.82rem;
      color: var(--text-muted);
      margin-top: 4px;
    }
    .market-detail-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 20px;
    }

    /* Pie chart via conic-gradient */
    .pie-wrap {
      display: flex;
      align-items: center;
      gap: 24px;
    }
    .pie-chart {
      width: 140px;
      height: 140px;
      border-radius: 50%;
      flex-shrink: 0;
      position: relative;
    }
    .pie-chart::after {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 70px;
      height: 70px;
      border-radius: 50%;
      background: var(--bg-card-solid);
    }
    .pie-legend {
      list-style: none;
      display: flex;
      flex-direction: column;
      gap: 8px;
    }
    .pie-legend li {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 0.82rem;
      color: var(--text);
    }
    .pie-legend-dot {
      width: 10px;
      height: 10px;
      border-radius: 3px;
      flex-shrink: 0;
    }
    .pie-legend-pct {
      color: var(--text-muted);
      margin-left: auto;
      font-weight: 600;
      font-variant-numeric: tabular-nums;
    }

    /* Recent transactions */
    .tx-list { list-style: none; max-height: 260px; overflow-y: auto; }
    .tx-item {
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 10px 0;
      border-bottom: 1px solid rgba(42, 42, 74, 0.3);
      font-size: 0.85rem;
    }
    .tx-item:last-child { border-bottom: none; }
    .tx-left { display: flex; align-items: center; gap: 10px; }
    .tx-icon {
      width: 32px;
      height: 32px;
      border-radius: 8px;
      background: rgba(232, 133, 12, 0.1);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.85rem;
    }
    .tx-name { color: var(--text-bright); font-weight: 600; }
    .tx-time { color: var(--text-muted); font-size: 0.72rem; }
    .tx-amount {
      color: var(--green);
      font-weight: 700;
      font-variant-numeric: tabular-nums;
    }

    /* ========== Footer ========== */
    .dashboard-footer {
      text-align: center;
      padding: 24px;
      margin-top: 20px;
      border-top: 1px solid var(--border);
      font-size: 0.78rem;
      color: var(--text-muted);
    }
    .dashboard-footer .orange { color: var(--orange); }

    /* ========== Animations ========== */
    .fade-in {
      opacity: 0;
      transform: translateY(20px);
      transition: opacity 0.6s ease, transform 0.6s ease;
    }
    .fade-in.visible {
      opacity: 1;
      transform: translateY(0);
    }

    @keyframes countUp {
      from { opacity: 0; transform: translateY(10px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .count-animated {
      animation: countUp 0.5s ease forwards;
    }

    /* Scrollbar styling */
    ::-webkit-scrollbar { width: 6px; }
    ::-webkit-scrollbar-track { background: transparent; }
    ::-webkit-scrollbar-thumb { background: var(--border); border-radius: 3px; }
    ::-webkit-scrollbar-thumb:hover { background: var(--border-light); }

    /* ========== Responsive ========== */
    @media (max-width: 1024px) {
      .health-top { grid-template-columns: 1fr 1fr 1fr; }
      .revenue-grid { grid-template-columns: 1fr; }
      .users-detail-grid { grid-template-columns: 1fr; }
      .market-detail-grid { grid-template-columns: 1fr; }
    }
    @media (max-width: 768px) {
      .dashboard-header { padding: 14px 16px; flex-wrap: wrap; gap: 10px; }
      .header-title { display: none; }
      .dashboard-body { padding: 16px; }
      .health-top { grid-template-columns: 1fr; }
      .users-stats-row { grid-template-columns: 1fr; }
      .market-top-row { grid-template-columns: 1fr; }
      .gauge-wrap { width: 120px; height: 120px; }
      .gauge-svg { width: 120px; height: 120px; }
      .gauge-value { font-size: 1.4rem; }
      .revenue-number { font-size: 2rem; }
      .alert-card { grid-template-columns: 4px 1fr; }
      .alert-actions { display: none; }
      .pie-wrap { flex-direction: column; }
      .header-right { flex-wrap: wrap; }
    }
    @media (max-width: 480px) {
      .engine-dot { width: 14px; height: 14px; }
      .engine-dots-row { gap: 7px; }
      .access-gate input { width: 280px; }
    }

    /* Touch & Mobile */
    * { -webkit-tap-highlight-color: transparent; }
    select, button, a { touch-action: manipulation; }
  </style>
</head>
<body>

  <!-- ========== Access Gate ========== -->
  <div class="access-gate" id="accessGate">
    <div class="lock-icon">&#128274;</div>
    <div class="access-gate-logo">SEO<span>BAIKE</span></div>
    <h2>指揮中心</h2>
    <p>僅限創辦人存取</p>
    <input type="password" id="accessCode" placeholder="請輸入存取碼" autocomplete="off">
    <button onclick="checkAccess()">進入指揮中心</button>
    <div class="error-msg" id="accessError"></div>
  </div>

  <!-- ========== Main Dashboard ========== -->
  <div id="mainContent">

    <!-- Header -->
    <div class="dashboard-header">
      <div class="header-left">
        <a href="/" class="header-logo" style="text-decoration:none;">SEO<span>BAIKE</span></a>
        <div class="header-title">指揮中心</div>
      </div>
      <div class="header-right">
        <div class="live-badge"><div class="live-dot"></div> 即時監控中</div>
        <div class="refresh-badge">每 <span class="countdown" id="countdown">30</span> 秒自動更新</div>
        <button class="btn-logout" onclick="doLogout()">登出</button>
      </div>
    </div>

    <div class="dashboard-body">

      <!-- ======================== -->
      <!-- SECTION 1: SYSTEM HEALTH -->
      <!-- ======================== -->
      <div class="section-block fade-in">
        <div class="section-title">
          <div class="icon health">&#9889;</div>
          系統健康度
        </div>

        <!-- 3 Gauges -->
        <div class="health-top">
          <div class="glass-card gauge-card">
            <div class="gauge-wrap">
              <svg class="gauge-svg" viewBox="0 0 140 140">
                <circle class="gauge-bg" cx="70" cy="70" r="58"/>
                <circle class="gauge-fill" id="gaugeCPU" cx="70" cy="70" r="58"
                  stroke="var(--orange)" stroke-dasharray="364.42" stroke-dashoffset="364.42"/>
              </svg>
              <div class="gauge-center">
                <div class="gauge-value" id="cpuValue">0</div>
                <div class="gauge-unit">%</div>
              </div>
            </div>
            <div class="gauge-label">CPU 使用率</div>
          </div>

          <div class="glass-card gauge-card">
            <div class="gauge-wrap">
              <svg class="gauge-svg" viewBox="0 0 140 140">
                <circle class="gauge-bg" cx="70" cy="70" r="58"/>
                <circle class="gauge-fill" id="gaugeMEM" cx="70" cy="70" r="58"
                  stroke="#5882ff" stroke-dasharray="364.42" stroke-dashoffset="364.42"/>
              </svg>
              <div class="gauge-center">
                <div class="gauge-value" id="memValue">0</div>
                <div class="gauge-unit">%</div>
              </div>
            </div>
            <div class="gauge-label">記憶體使用率</div>
          </div>

          <div class="glass-card gauge-card">
            <div class="gauge-wrap">
              <svg class="gauge-svg" viewBox="0 0 140 140">
                <circle class="gauge-bg" cx="70" cy="70" r="58"/>
                <circle class="gauge-fill" id="gaugeUP" cx="70" cy="70" r="58"
                  stroke="var(--green)" stroke-dasharray="364.42" stroke-dashoffset="364.42"/>
              </svg>
              <div class="gauge-center">
                <div class="gauge-value" id="upValue">0</div>
                <div class="gauge-unit">%</div>
              </div>
            </div>
            <div class="gauge-label">運行時間</div>
          </div>
        </div>

        <!-- Engine dots -->
        <div class="glass-card engine-dots-card">
          <div style="text-align:center; margin-bottom:8px; font-size:0.85rem; color:var(--text-muted); font-weight:600;">引擎狀態一覽（15 個引擎）</div>
          <div class="engine-dots-row" id="engineDots">
            <!-- JS rendered -->
          </div>
          <div class="dots-legend">
            <div class="dots-legend-item"><div class="dots-legend-color" style="background:var(--green);"></div>正常</div>
            <div class="dots-legend-item"><div class="dots-legend-color" style="background:var(--yellow);"></div>緩慢</div>
            <div class="dots-legend-item"><div class="dots-legend-color" style="background:var(--red);"></div>離線</div>
          </div>
          <div class="timestamp-bar">最後更新：<span id="lastUpdated">--</span></div>
        </div>
      </div>

      <!-- ==================== -->
      <!-- SECTION 2: REVENUE   -->
      <!-- ==================== -->
      <div class="section-block fade-in">
        <div class="section-title">
          <div class="icon revenue">&#128176;</div>
          營收即時看板
        </div>

        <div class="revenue-grid">
          <div class="glass-card revenue-big">
            <div class="revenue-label">今日營收</div>
            <div class="revenue-number"><span class="currency">NT$</span> <span id="revenueToday">0</span></div>
            <div class="revenue-sub">較昨日 <span class="up" id="revenueTodayGrowth">+0%</span></div>
            <div style="height:20px;"></div>
            <div class="revenue-label">本月累計營收</div>
            <div class="revenue-number" style="font-size:1.8rem;"><span class="currency">NT$</span> <span id="revenueMonth">0</span></div>
            <div class="revenue-sub">目標達成率 <span class="up" id="revenueMonthPct">0%</span></div>
          </div>

          <div class="glass-card">
            <div style="font-size:0.85rem; color:var(--text-muted); font-weight:600; margin-bottom:8px;">7 日營收趨勢</div>
            <div class="bar-chart" id="revenueChart">
              <!-- JS rendered -->
            </div>
          </div>
        </div>

        <div class="glass-card" style="margin-top:20px;">
          <div style="font-size:0.85rem; color:var(--text-muted); font-weight:600; margin-bottom:12px;">本月 Top 5 賣家排行</div>
          <table class="sellers-table">
            <thead>
              <tr>
                <th style="width:40px;">排名</th>
                <th>賣家</th>
                <th style="text-align:right;">營收額</th>
                <th style="text-align:right;">交易數</th>
              </tr>
            </thead>
            <tbody id="sellersBody">
              <!-- JS rendered -->
            </tbody>
          </table>
        </div>
      </div>

      <!-- ========================= -->
      <!-- SECTION 3: USER ACTIVITY  -->
      <!-- ========================= -->
      <div class="section-block fade-in">
        <div class="section-title">
          <div class="icon users">&#128101;</div>
          使用者活動
        </div>

        <div class="users-stats-row">
          <div class="glass-card user-stat-card">
            <div class="user-stat-num" id="totalUsers">0</div>
            <div class="user-stat-label">總使用者</div>
          </div>
          <div class="glass-card user-stat-card">
            <div class="user-stat-num" id="newToday">0</div>
            <div class="user-stat-label">今日新增</div>
          </div>
          <div class="glass-card user-stat-card">
            <div class="user-stat-num" id="activeNow" style="color:var(--green);">0</div>
            <div class="user-stat-label">目前在線</div>
          </div>
        </div>

        <div class="users-detail-grid">
          <div class="glass-card">
            <div style="font-size:0.85rem; color:var(--text-muted); font-weight:600; margin-bottom:12px;">最近註冊（最新 10 位）</div>
            <ul class="signup-list" id="signupList">
              <!-- JS rendered -->
            </ul>
          </div>

          <div class="glass-card">
            <div style="font-size:0.85rem; color:var(--text-muted); font-weight:600; margin-bottom:12px;">流量來源國家</div>
            <ul class="country-list" id="countryList">
              <!-- JS rendered -->
            </ul>
          </div>
        </div>
      </div>

      <!-- ================================ -->
      <!-- SECTION 4: CHEATER DETECTION     -->
      <!-- ================================ -->
      <div class="section-block fade-in">
        <div class="section-title">
          <div class="icon alert">&#9888;&#65039;</div>
          異常偵測
        </div>

        <div class="alert-grid" id="alertGrid">
          <!-- JS rendered -->
        </div>
      </div>

      <!-- ============================== -->
      <!-- SECTION 5: MARKETPLACE STATS   -->
      <!-- ============================== -->
      <div class="section-block fade-in">
        <div class="section-title">
          <div class="icon market">&#128722;</div>
          市集統計
        </div>

        <div class="market-top-row">
          <div class="glass-card market-stat">
            <div class="market-stat-num" id="totalListings">0</div>
            <div class="market-stat-label">上架商品數</div>
          </div>
          <div class="glass-card market-stat">
            <div class="market-stat-num" id="pendingReview" style="color:var(--yellow);">0</div>
            <div class="market-stat-label">待審核</div>
          </div>
          <div class="glass-card market-stat">
            <div class="market-stat-num" id="salesToday" style="color:var(--green);">0</div>
            <div class="market-stat-label">今日成交</div>
          </div>
        </div>

        <div class="market-detail-grid">
          <div class="glass-card">
            <div style="font-size:0.85rem; color:var(--text-muted); font-weight:600; margin-bottom:16px;">類別佔比</div>
            <div class="pie-wrap">
              <div class="pie-chart" id="pieChart"></div>
              <ul class="pie-legend" id="pieLegend">
                <!-- JS rendered -->
              </ul>
            </div>
          </div>

          <div class="glass-card">
            <div style="font-size:0.85rem; color:var(--text-muted); font-weight:600; margin-bottom:12px;">最近交易</div>
            <ul class="tx-list" id="txList">
              <!-- JS rendered -->
            </ul>
          </div>
        </div>
      </div>

    </div><!-- /dashboard-body -->

    <!-- Footer -->
    <div class="dashboard-footer">
      僅限創辦人存取 &mdash; <span class="orange">小路光有限公司</span>（統編 60475510）
    </div>

  </div><!-- /mainContent -->

  <script>
    /* ======================================================= */
    /* ACCESS GATE                                              */
    /* ======================================================= */
    var ACCESS_KEY = 'seobaike_command_center_verified';
    var ACCESS_CODE = 'seobaike2026';

    function checkAccess() {
      var code = document.getElementById('accessCode').value;
      if (code === ACCESS_CODE) {
        localStorage.setItem(ACCESS_KEY, 'true');
        showMainContent();
      } else {
        document.getElementById('accessError').textContent = '存取碼錯誤，請重試';
        document.getElementById('accessCode').value = '';
        document.getElementById('accessCode').focus();
      }
    }

    document.getElementById('accessCode').addEventListener('keydown', function(e) {
      if (e.key === 'Enter') checkAccess();
    });

    function doLogout() {
      localStorage.removeItem(ACCESS_KEY);
      location.reload();
    }

    function showMainContent() {
      document.getElementById('accessGate').classList.add('hidden');
      document.getElementById('mainContent').style.display = 'block';
      initDashboard();
      setTimeout(function() {
        document.querySelectorAll('.fade-in').forEach(function(el) {
          observer.observe(el);
        });
      }, 100);
    }

    /* Scroll observer */
    var observer = new IntersectionObserver(function(entries) {
      entries.forEach(function(entry) {
        if (entry.isIntersecting) {
          entry.target.classList.add('visible');
        }
      });
    }, { threshold: 0.05 });

    if (localStorage.getItem(ACCESS_KEY) === 'true') {
      showMainContent();
    }

    /* ======================================================= */
    /* DASHBOARD DATA & STATE                                   */
    /* ======================================================= */
    var countdownValue = 30;
    var countdownTimer = null;
    var dashboardInitialized = false;

    /* Engine names (internal only, not displayed) */
    var ENGINE_IDS = [
      'fast-chat', 'deep-reason', 'realtime-search', 'multilingual', 'all-round',
      'creative', 'ultra-fast', 'text-expert', 'research', 'gpu-compute',
      'open-source', 'video-create', 'image-gen', 'math-expert', 'browser-ai'
    ];
    var ENGINE_LABELS = [
      '#01', '#02', '#03', '#04', '#05', '#06', '#07', '#08',
      '#09', '#10', '#11', '#12', '#13', '#14', '#15'
    ];

    var engineStatuses = [];
    var dashData = {};

    /* ======================================================= */
    /* UTILITY: Animated counter                                */
    /* ======================================================= */
    function animateCounter(el, target, duration, prefix, suffix) {
      prefix = prefix || '';
      suffix = suffix || '';
      duration = duration || 1200;
      var start = 0;
      var startTime = null;
      function step(ts) {
        if (!startTime) startTime = ts;
        var progress = Math.min((ts - startTime) / duration, 1);
        var eased = 1 - Math.pow(1 - progress, 3); // ease out cubic
        var current = Math.round(eased * target);
        el.textContent = prefix + current.toLocaleString() + suffix;
        if (progress < 1) requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }

    function animateGauge(circleEl, valueEl, targetPct, color) {
      var circumference = 2 * Math.PI * 58; // 364.42
      var offset = circumference - (targetPct / 100) * circumference;
      circleEl.style.strokeDashoffset = offset;

      // Change color based on value
      if (color) {
        circleEl.setAttribute('stroke', color);
      }

      // Animate number
      var current = { v: 0 };
      var start = performance.now();
      var dur = 1500;
      function step(ts) {
        var progress = Math.min((ts - start) / dur, 1);
        var eased = 1 - Math.pow(1 - progress, 3);
        valueEl.textContent = Math.round(eased * targetPct);
        if (progress < 1) requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }

    /* ======================================================= */
    /* GENERATE DASHBOARD DATA                                  */
    /* ======================================================= */
    function generateData() {
      var hour = new Date().getHours();

      // Engine statuses
      engineStatuses = ENGINE_IDS.map(function() {
        var r = Math.random();
        if (r > 0.97) return 'offline';
        if (r > 0.92) return 'degraded';
        return 'online';
      });

      // System health
      var cpuBase = 25 + Math.sin(hour / 3) * 15;
      dashData.cpu = Math.round(Math.max(8, Math.min(85, cpuBase + (Math.random() - 0.5) * 20)));
      dashData.mem = Math.round(40 + Math.random() * 25);
      dashData.uptime = +(99.5 + Math.random() * 0.49).toFixed(2);

      // Revenue
      dashData.revenueToday = Math.round(15000 + Math.random() * 35000 + hour * 1200);
      dashData.revenueTodayGrowth = +(5 + Math.random() * 18).toFixed(1);
      dashData.revenueMonth = Math.round(dashData.revenueToday * 16 + Math.random() * 100000);
      dashData.revenueMonthPct = Math.round(45 + Math.random() * 35);

      // 7-day revenue
      dashData.revenueDays = [];
      var days = ['日', '一', '二', '三', '四', '五', '六'];
      var now = new Date();
      for (var i = 6; i >= 0; i--) {
        var d = new Date(now);
        d.setDate(d.getDate() - i);
        var dayName = '週' + days[d.getDay()];
        var val = Math.round(12000 + Math.random() * 40000);
        dashData.revenueDays.push({ label: dayName, value: val });
      }

      // Top 5 sellers
      var sellerNames = ['AI 圖片生成器', '多語言翻譯包', '即時搜尋 API', 'SEO 分析套件', '智能客服模組'];
      dashData.sellers = sellerNames.map(function(name, i) {
        return {
          rank: i + 1,
          name: name,
          revenue: Math.round(8000 - i * 1200 + Math.random() * 3000),
          orders: Math.round(50 - i * 8 + Math.random() * 20)
        };
      }).sort(function(a, b) { return b.revenue - a.revenue; });

      // Users
      dashData.totalUsers = Math.round(4200 + Math.random() * 800);
      dashData.newToday = Math.round(15 + Math.random() * 35);
      dashData.activeNow = Math.round(80 + Math.random() * 120 + (hour > 8 && hour < 22 ? 50 : 0));

      // Recent signups
      var surnames = ['王', '李', '陳', '林', '張', '黃', '吳', '劉', '蔡', '楊', '許', '鄭', '謝', '郭', '洪'];
      var names = ['小明', '美玲', '志豪', '淑芬', '建宏', '雅婷', '家豪', '怡君', '俊傑', '佳蓉'];
      dashData.signups = [];
      for (var s = 0; s < 10; s++) {
        var sn = surnames[Math.floor(Math.random() * surnames.length)];
        var fn = names[Math.floor(Math.random() * names.length)];
        var minsAgo = Math.round(s * 8 + Math.random() * 15);
        dashData.signups.push({
          name: sn + fn,
          email: 'user' + Math.round(Math.random() * 9000 + 1000) + '@mail.com',
          time: minsAgo === 0 ? '剛剛' : minsAgo + ' 分鐘前'
        });
      }

      // Country traffic
      dashData.countries = [
        { flag: '\uD83C\uDDF9\uD83C\uDDFC', name: '台灣', pct: 42 + Math.round(Math.random() * 8), color: 'var(--orange)' },
        { flag: '\uD83C\uDDF0\uD83C\uDDF7', name: '韓國', pct: 18 + Math.round(Math.random() * 5), color: '#5882ff' },
        { flag: '\uD83C\uDDEF\uD83C\uDDF5', name: '日本', pct: 14 + Math.round(Math.random() * 4), color: '#ff5f87' },
        { flag: '\uD83C\uDDFA\uD83C\uDDF8', name: '美國', pct: 10 + Math.round(Math.random() * 3), color: '#28c840' },
        { flag: '\uD83C\uDF10', name: '其他', pct: 0, color: '#8888aa' }
      ];
      var usedPct = dashData.countries.slice(0, 4).reduce(function(a, c) { return a + c.pct; }, 0);
      dashData.countries[4].pct = Math.max(0, 100 - usedPct);

      // Alerts (demo)
      dashData.alerts = [
        {
          severity: 'critical',
          title: 'API 用量異常飆升',
          desc: '帳號 user_38291 過去 1 小時發送了 12,847 次 API 請求，超出正常用量 25 倍。可能為自動化攻擊或未授權爬取。',
          time: '3 分鐘前'
        },
        {
          severity: 'warning',
          title: '未付款帳戶仍在使用',
          desc: '帳號 shop_premium_72 已逾期 14 天未付款（NT$8,500），但仍持續使用付費功能。建議立即凍結或降級。',
          time: '28 分鐘前'
        },
        {
          severity: 'warning',
          title: '可疑註冊行為',
          desc: '過去 30 分鐘內偵測到 7 個帳號從同一 IP（203.145.xx.xx）註冊，疑似機器人批量註冊。',
          time: '45 分鐘前'
        },
        {
          severity: 'info',
          title: '系統自動封鎖完成',
          desc: '帳號 test_bot_01 因連續 50 次認證失敗，已被自動封鎖 24 小時。',
          time: '1 小時前'
        }
      ];

      // Marketplace
      dashData.totalListings = Math.round(280 + Math.random() * 50);
      dashData.pendingReview = Math.round(8 + Math.random() * 12);
      dashData.salesToday = Math.round(25 + Math.random() * 30);

      // Marketplace categories
      dashData.categories = [
        { name: 'SEO 工具', pct: 32, color: 'var(--orange)' },
        { name: 'AI 對話', pct: 24, color: '#5882ff' },
        { name: '圖片生成', pct: 18, color: '#ff5f87' },
        { name: '翻譯服務', pct: 14, color: '#28c840' },
        { name: '數據分析', pct: 8, color: '#ac82ff' },
        { name: '其他', pct: 4, color: '#8888aa' }
      ];

      // Recent transactions
      var products = ['SEO 自動分析器', '即時翻譯 API', 'AI 圖片包月', '關鍵字探勘工具', '智能摘要引擎', '多語言 SEO 包'];
      dashData.transactions = [];
      for (var t = 0; t < 8; t++) {
        var product = products[Math.floor(Math.random() * products.length)];
        var tMinsAgo = Math.round(t * 12 + Math.random() * 20);
        dashData.transactions.push({
          name: product,
          amount: Math.round(500 + Math.random() * 4500),
          time: tMinsAgo === 0 ? '剛剛' : tMinsAgo + ' 分鐘前'
        });
      }
    }

    /* ======================================================= */
    /* RENDER FUNCTIONS                                         */
    /* ======================================================= */

    function renderGauges() {
      var cpuColor = dashData.cpu > 70 ? 'var(--red)' : dashData.cpu > 50 ? 'var(--yellow)' : 'var(--orange)';
      var memColor = dashData.mem > 80 ? 'var(--red)' : dashData.mem > 60 ? 'var(--yellow)' : '#5882ff';

      animateGauge(
        document.getElementById('gaugeCPU'),
        document.getElementById('cpuValue'),
        dashData.cpu,
        cpuColor
      );
      animateGauge(
        document.getElementById('gaugeMEM'),
        document.getElementById('memValue'),
        dashData.mem,
        memColor
      );
      animateGauge(
        document.getElementById('gaugeUP'),
        document.getElementById('upValue'),
        dashData.uptime,
        'var(--green)'
      );
    }

    function renderEngineDots() {
      var container = document.getElementById('engineDots');
      var html = '';
      for (var i = 0; i < 15; i++) {
        var status = engineStatuses[i] || 'online';
        var label = ENGINE_LABELS[i] + ' ' + (status === 'online' ? '正常' : status === 'degraded' ? '緩慢' : '離線');
        html += '<div class="engine-dot ' + status + '" data-tip="' + label + '"></div>';
      }
      container.innerHTML = html;
    }

    function renderTimestamp() {
      var now = new Date();
      var y = now.getFullYear();
      var mo = String(now.getMonth() + 1).padStart(2, '0');
      var d = String(now.getDate()).padStart(2, '0');
      var h = String(now.getHours()).padStart(2, '0');
      var mi = String(now.getMinutes()).padStart(2, '0');
      var s = String(now.getSeconds()).padStart(2, '0');
      document.getElementById('lastUpdated').textContent = y + '/' + mo + '/' + d + ' ' + h + ':' + mi + ':' + s;
    }

    function renderRevenue() {
      animateCounter(document.getElementById('revenueToday'), dashData.revenueToday, 1500);
      document.getElementById('revenueTodayGrowth').textContent = '+' + dashData.revenueTodayGrowth + '%';
      animateCounter(document.getElementById('revenueMonth'), dashData.revenueMonth, 2000);
      document.getElementById('revenueMonthPct').textContent = dashData.revenueMonthPct + '%';

      // 7-day bar chart
      var maxVal = Math.max.apply(null, dashData.revenueDays.map(function(d) { return d.value; }));
      var chart = document.getElementById('revenueChart');
      var html = '';
      dashData.revenueDays.forEach(function(day) {
        var heightPct = Math.max(8, (day.value / maxVal) * 100);
        var displayVal = 'NT$' + Math.round(day.value / 1000) + 'K';
        html += '<div class="bar-col">' +
          '<div class="bar-fill" style="height:' + heightPct + '%" data-val="' + displayVal + '"></div>' +
          '<div class="bar-label">' + day.label + '</div>' +
          '</div>';
      });
      chart.innerHTML = html;
    }

    function renderSellers() {
      var tbody = document.getElementById('sellersBody');
      var html = '';
      dashData.sellers.forEach(function(seller, i) {
        var rankClass = 'r' + (i + 1);
        html += '<tr>' +
          '<td><span class="rank-badge ' + rankClass + '">' + (i + 1) + '</span></td>' +
          '<td style="color:var(--text-bright);font-weight:600;">' + seller.name + '</td>' +
          '<td style="text-align:right;" class="seller-amount">NT$' + seller.revenue.toLocaleString() + '</td>' +
          '<td style="text-align:right;color:var(--text-muted);">' + seller.orders + ' 筆</td>' +
          '</tr>';
      });
      tbody.innerHTML = html;
    }

    function renderUsers() {
      animateCounter(document.getElementById('totalUsers'), dashData.totalUsers, 1200);
      animateCounter(document.getElementById('newToday'), dashData.newToday, 800);
      animateCounter(document.getElementById('activeNow'), dashData.activeNow, 1000);

      // Signups
      var list = document.getElementById('signupList');
      var html = '';
      dashData.signups.forEach(function(u) {
        var initials = u.name.charAt(0);
        html += '<li>' +
          '<div class="signup-avatar">' + initials + '</div>' +
          '<div class="signup-info">' +
            '<div class="signup-name">' + u.name + '</div>' +
            '<div class="signup-time">' + u.email + '</div>' +
          '</div>' +
          '<div style="font-size:0.72rem;color:var(--text-muted);white-space:nowrap;">' + u.time + '</div>' +
          '</li>';
      });
      list.innerHTML = html;

      // Countries
      var clist = document.getElementById('countryList');
      html = '';
      dashData.countries.forEach(function(c) {
        html += '<div class="country-item">' +
          '<div class="country-name">' + c.flag + ' ' + c.name + '</div>' +
          '<div class="country-bar-wrap"><div class="country-bar-fill" style="width:' + c.pct + '%;background:' + c.color + ';"></div></div>' +
          '<div class="country-pct">' + c.pct + '%</div>' +
          '</div>';
      });
      clist.innerHTML = html;
    }

    function renderAlerts() {
      var grid = document.getElementById('alertGrid');
      var html = '';
      dashData.alerts.forEach(function(alert) {
        html += '<div class="alert-card">' +
          '<div class="alert-severity ' + alert.severity + '"></div>' +
          '<div class="alert-body">' +
            '<div class="alert-title">' + alert.title + '</div>' +
            '<div class="alert-desc">' + alert.desc + '</div>' +
            '<div class="alert-time">' + alert.time + '</div>' +
          '</div>' +
          '<div class="alert-actions">' +
            '<button class="btn-handle" onclick="handleAlert(this)">處理</button>' +
          '</div>' +
          '</div>';
      });
      grid.innerHTML = html;
    }

    function handleAlert(btn) {
      var card = btn.closest('.alert-card');
      card.style.opacity = '0.4';
      card.style.transform = 'translateX(20px)';
      btn.textContent = '已處理';
      btn.disabled = true;
      btn.style.color = 'var(--green)';
      btn.style.borderColor = 'var(--green)';
    }

    function renderMarketplace() {
      animateCounter(document.getElementById('totalListings'), dashData.totalListings, 1000);
      animateCounter(document.getElementById('pendingReview'), dashData.pendingReview, 600);
      animateCounter(document.getElementById('salesToday'), dashData.salesToday, 800);

      // Pie chart via conic-gradient
      var pie = document.getElementById('pieChart');
      var legend = document.getElementById('pieLegend');
      var angle = 0;
      var gradientParts = [];
      var legendHtml = '';

      dashData.categories.forEach(function(cat) {
        var startAngle = angle;
        angle += cat.pct * 3.6; // 360 / 100
        gradientParts.push(cat.color + ' ' + startAngle + 'deg ' + angle + 'deg');
        legendHtml += '<li>' +
          '<div class="pie-legend-dot" style="background:' + cat.color + ';"></div>' +
          cat.name +
          '<span class="pie-legend-pct">' + cat.pct + '%</span>' +
          '</li>';
      });

      pie.style.background = 'conic-gradient(' + gradientParts.join(', ') + ')';
      legend.innerHTML = legendHtml;

      // Recent transactions
      var txList = document.getElementById('txList');
      var html = '';
      dashData.transactions.forEach(function(tx) {
        html += '<li class="tx-item">' +
          '<div class="tx-left">' +
            '<div class="tx-icon">&#128179;</div>' +
            '<div>' +
              '<div class="tx-name">' + tx.name + '</div>' +
              '<div class="tx-time">' + tx.time + '</div>' +
            '</div>' +
          '</div>' +
          '<div class="tx-amount">+NT$' + tx.amount.toLocaleString() + '</div>' +
          '</li>';
      });
      txList.innerHTML = html;
    }

    /* ======================================================= */
    /* REFRESH & COUNTDOWN                                      */
    /* ======================================================= */
    function refreshDashboard() {
      generateData();
      renderGauges();
      renderEngineDots();
      renderTimestamp();
      renderRevenue();
      renderSellers();
      renderUsers();
      renderAlerts();
      renderMarketplace();
    }

    function startCountdown() {
      countdownValue = 30;
      document.getElementById('countdown').textContent = countdownValue;
      if (countdownTimer) clearInterval(countdownTimer);
      countdownTimer = setInterval(function() {
        countdownValue--;
        if (countdownValue <= 0) {
          countdownValue = 30;
          refreshDashboard();
        }
        document.getElementById('countdown').textContent = countdownValue;
      }, 1000);
    }

    /* Periodically jitter activeNow */
    function jitterActiveNow() {
      var el = document.getElementById('activeNow');
      if (!el) return;
      var current = parseInt(el.textContent.replace(/,/g, ''), 10) || dashData.activeNow;
      var delta = Math.round((Math.random() - 0.45) * 5);
      current = Math.max(20, current + delta);
      el.textContent = current.toLocaleString();
    }

    /* ======================================================= */
    /* INIT                                                     */
    /* ======================================================= */
    function initDashboard() {
      if (dashboardInitialized) return;
      dashboardInitialized = true;

      refreshDashboard();
      startCountdown();
      setInterval(jitterActiveNow, 3000);
    }

    /* ======================================================= */
    /* PAGE VIEW TRACKING                                       */
    /* ======================================================= */
    (function(){
      try {
        var sUrl = 'https://vmyrivxxibqydccurxug.supabase.co';
        var sKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InZteXJpdnh4aWJxeWRjY3VyeHVnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NzAwNDAwMjksImV4cCI6MjA4NTYxNjAyOX0.iBV-23LGdm_uKffAExgqSV34-NWoAyv8_-M_cJQZ8Gg';
        fetch(sUrl + '/rest/v1/page_views', {
          method: 'POST',
          headers: { 'Content-Type':'application/json', 'apikey':sKey, 'Authorization':'Bearer '+sKey, 'Prefer':'return=minimal' },
          body: JSON.stringify({ path: location.pathname, referrer: document.referrer || null, user_agent: navigator.userAgent })
        }).catch(function(){});
      } catch(e){}
    })();
  </script>
</body>
</html>
