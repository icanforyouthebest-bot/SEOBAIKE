<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>SEOBAIKE å¸‚é›† â€” AI å·¥å…·å¹³å° | å¹«ä½ æ‰¾åˆ°å°çš„å·¥å…·</title>
<meta name="description" content="SEOBAIKE å¸‚é›†ï¼š20+ AI å·¥å…·ä¸€éµä½¿ç”¨ï¼Œå¹«ä½ æ‰¾åˆ°å°çš„å·¥å…·ï¼Œåˆ†äº«å¥½æ±è¥¿çµ¦æœ‹å‹ã€‚å°ç£ AI OS å¹³å°ã€‚">
<link rel="icon" href="/favicon.svg" type="image/svg+xml">
<style>
*{margin:0;padding:0;box-sizing:border-box}
body{font-family:'Segoe UI',system-ui,sans-serif;background:#0a0a1a;color:#eee;min-height:100vh}
a{color:#e8850c;text-decoration:none}
a:hover{text-decoration:underline}

/* Nav */
.nav{background:rgba(10,10,26,0.95);backdrop-filter:blur(10px);border-bottom:1px solid #222;padding:12px 30px;display:flex;align-items:center;gap:16px;position:sticky;top:0;z-index:100}
.nav .logo{font-size:20px;font-weight:800;color:#e8850c}
.nav a{color:#999;font-size:14px;padding:6px 12px;border-radius:8px;transition:all 0.2s}
.nav a:hover,.nav a.active{color:#fff;background:#1a1a2e;text-decoration:none}
.nav .earn{background:linear-gradient(135deg,#e8850c,#cc785c);color:#fff;font-weight:700;padding:8px 16px;border-radius:20px;font-size:13px}

/* Hero */
.hero{background:linear-gradient(135deg,#1a1a2e 0%,#16213e 50%,#0a0a1a 100%);padding:60px 30px 40px;text-align:center;border-bottom:1px solid #222}
.hero h1{font-size:42px;font-weight:800;margin-bottom:12px}
.hero h1 span{background:linear-gradient(135deg,#e8850c,#cc785c);-webkit-background-clip:text;-webkit-text-fill-color:transparent}
.hero p{color:#999;font-size:18px;max-width:700px;margin:0 auto 24px}
.hero-stats{display:flex;justify-content:center;gap:40px;margin-top:24px}
.hero-stat .num{font-size:32px;font-weight:800;color:#e8850c}
.hero-stat .lbl{font-size:12px;color:#888}

/* Commission Banner */
.commission-bar{background:linear-gradient(90deg,#16213e,#1a1a2e);border:1px solid #333;border-radius:16px;margin:20px 30px;padding:20px 30px;display:flex;align-items:center;gap:24px;flex-wrap:wrap}
.commission-bar h3{color:#e8850c;font-size:16px;white-space:nowrap}
.split{display:flex;gap:12px;flex:1;flex-wrap:wrap}
.split-item{background:#0a0a1a;border:1px solid #333;border-radius:10px;padding:8px 14px;text-align:center;min-width:100px}
.split-item .pct{font-size:20px;font-weight:800;color:#76b900}
.split-item .role{font-size:11px;color:#888}
.split-item.you .pct{color:#e8850c}

/* Search */
.search-section{padding:20px 30px;display:flex;gap:12px;flex-wrap:wrap;align-items:center}
.search-box{flex:1;min-width:250px;padding:12px 20px;border-radius:24px;border:1px solid #333;background:#16213e;color:#eee;font-size:15px;outline:none}
.search-box:focus{border-color:#e8850c}
.filter-btn{padding:8px 16px;border-radius:20px;border:1px solid #333;background:#16213e;color:#ccc;cursor:pointer;font-size:13px;transition:all 0.2s}
.filter-btn:hover,.filter-btn.active{background:#e8850c;color:#fff;border-color:#e8850c}

/* Grid */
.grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(320px,1fr));gap:16px;padding:0 30px 30px}

/* Card */
.card{background:#16213e;border:1px solid #222;border-radius:16px;overflow:hidden;transition:all 0.3s;cursor:pointer;position:relative}
.card:hover{border-color:#e8850c;transform:translateY(-3px);box-shadow:0 8px 30px rgba(232,133,12,0.15)}
.card-head{padding:16px 18px 0;display:flex;align-items:flex-start;gap:12px}
.card-icon{font-size:36px;flex-shrink:0}
.card-info{flex:1;min-width:0}
.card-info h3{font-size:16px;font-weight:700;margin-bottom:2px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.card-info .sub{font-size:12px;color:#999;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.card-badge{position:absolute;top:12px;right:12px;background:#e8850c;color:#fff;font-size:10px;font-weight:700;padding:3px 8px;border-radius:8px}
.card-body{padding:10px 18px}
.card-body p{font-size:13px;color:#bbb;line-height:1.6;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}
.card-tags{padding:6px 18px;display:flex;gap:6px;flex-wrap:wrap}
.tag{background:#0a0a1a;color:#888;font-size:11px;padding:3px 8px;border-radius:6px}
.card-foot{padding:10px 18px 14px;display:flex;justify-content:space-between;align-items:center;border-top:1px solid #1a1a2e}
.card-foot .price{font-size:18px;font-weight:800;color:#76b900}
.card-foot .price.free{color:#e8850c}
.card-foot .stats{display:flex;gap:12px;font-size:12px;color:#888}
.card-foot .stats span{display:flex;align-items:center;gap:3px}
.use-btn{padding:8px 18px;border-radius:20px;border:none;background:#e8850c;color:#fff;font-weight:700;font-size:13px;cursor:pointer;transition:all 0.2s}
.use-btn:hover{background:#cc785c}

/* Create Section */
.create-section{margin:20px 30px;background:linear-gradient(135deg,#16213e,#1a1a2e);border:1px solid #333;border-radius:16px;padding:40px;text-align:center}
.create-section h2{font-size:28px;margin-bottom:8px}
.create-section h2 span{color:#e8850c}
.create-section p{color:#999;margin-bottom:20px;font-size:15px}
.create-btn{display:inline-block;padding:14px 32px;border-radius:24px;background:linear-gradient(135deg,#e8850c,#cc785c);color:#fff;font-weight:700;font-size:16px;border:none;cursor:pointer;transition:all 0.3s}
.create-btn:hover{transform:scale(1.05);box-shadow:0 8px 30px rgba(232,133,12,0.3)}

/* How it works */
.how{padding:30px;display:grid;grid-template-columns:repeat(auto-fill,minmax(240px,1fr));gap:16px}
.how-card{background:#16213e;border:1px solid #222;border-radius:14px;padding:24px;text-align:center}
.how-card .step{font-size:36px;font-weight:800;color:#e8850c;margin-bottom:8px}
.how-card h4{font-size:15px;margin-bottom:6px}
.how-card p{font-size:13px;color:#888;line-height:1.5}

/* Why Section */
.why-section{margin:20px 30px;background:linear-gradient(135deg,#16213e,#1a1a2e);border:1px solid #333;border-radius:16px;padding:40px}
.why-section h2{font-size:28px;margin-bottom:8px;text-align:center}
.why-section h2 span{color:#e8850c}
.why-section>p{color:#999;margin-bottom:28px;font-size:15px;text-align:center;max-width:600px;margin-left:auto;margin-right:auto}
.why-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(280px,1fr));gap:16px;margin-bottom:28px}
.why-card{background:#0a0a1a;border:1px solid #333;border-radius:14px;padding:24px;text-align:center;transition:all 0.3s}
.why-card:hover{border-color:#e8850c;transform:translateY(-2px)}
.why-card .why-icon{font-size:40px;margin-bottom:12px}
.why-card h4{font-size:16px;margin-bottom:6px;color:#eee}
.why-card p{font-size:13px;color:#888;line-height:1.6}
.why-card .why-highlight{color:#e8850c;font-weight:700;font-size:20px;margin-top:8px}
.why-cta{text-align:center}
.why-cta-btn{display:inline-block;padding:14px 36px;border-radius:24px;background:linear-gradient(135deg,#e8850c,#cc785c);color:#fff;font-weight:700;font-size:16px;border:none;cursor:pointer;transition:all 0.3s}
.why-cta-btn:hover{transform:scale(1.05);box-shadow:0 8px 30px rgba(232,133,12,0.3)}

/* Footer */
.footer{text-align:center;padding:30px;color:#555;font-size:12px;border-top:1px solid #222;margin-top:20px}
.footer a{color:#e8850c}

/* Modal */
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,0.7);z-index:200;justify-content:center;align-items:center}
.modal-overlay.show{display:flex}
.modal{background:#16213e;border:1px solid #333;border-radius:20px;padding:30px;max-width:600px;width:90%;max-height:80vh;overflow-y:auto}
.modal h2{font-size:22px;margin-bottom:12px}
.modal .close{float:right;font-size:24px;cursor:pointer;color:#888;background:none;border:none}
.modal .close:hover{color:#fff}
.modal-field{margin-bottom:14px}
.modal-field label{display:block;font-size:13px;color:#888;margin-bottom:4px}
.modal-field input,.modal-field textarea,.modal-field select{width:100%;padding:10px 14px;border-radius:10px;border:1px solid #333;background:#0a0a1a;color:#eee;font-size:14px;outline:none}
.modal-field textarea{height:80px;resize:vertical}
.modal-submit{width:100%;padding:12px;border-radius:20px;border:none;background:linear-gradient(135deg,#e8850c,#cc785c);color:#fff;font-weight:700;font-size:15px;cursor:pointer;margin-top:8px}

@media(max-width:768px){
  .hero h1{font-size:28px}
  .hero-stats{gap:20px}
  .commission-bar{flex-direction:column;text-align:center}
  .nav{flex-wrap:wrap;gap:8px}
}
</style>
</head>
<body>

<nav class="nav">
  <span class="logo">SEOBAIKE</span>
  <a href="/">é¦–é </a>
  <a href="/marketplace" class="active">å¸‚é›†</a>
  <a href="/ecosystem">ç”Ÿæ…‹ç³»</a>
  <a href="/pricing">æ–¹æ¡ˆ</a>
  <a href="/docs">API</a>
  <a class="earn" href="#earn" onclick="document.getElementById('createModal').classList.add('show')">ä¸€éµä¸Šæ¶åˆ†äº«</a>
</nav>

<section class="hero">
  <h1>SEOBAIKE <span>å¸‚é›†</span></h1>
  <p>è¦ä»€éº¼æœ‰ä»€éº¼çš„ AI OS â€” å–œæ­¡è‚¡ç¥¨å°±çµ¦è‚¡ç¥¨ç³»çµ±ï¼Œå–œæ­¡æ£’çƒå°±çµ¦æ£’çƒç³»çµ±ã€‚å¹«ä½ æ‰¾åˆ°å°çš„å·¥å…·ï¼Œåˆ†äº«å¥½æ±è¥¿çµ¦æœ‹å‹ã€‚</p>
  <div class="hero-stats">
    <div class="hero-stat"><div class="num" id="stat-listings">--</div><div class="lbl">AI å·¥å…·</div></div>
    <div class="hero-stat"><div class="num" id="stat-users">--</div><div class="lbl">ä½¿ç”¨è€…</div></div>
    <div class="hero-stat"><div class="num" id="stat-categories">--</div><div class="lbl">ç”¢æ¥­é¡åˆ¥</div></div>
    <div class="hero-stat"><div class="num" id="stat-commission">70%</div><div class="lbl">é–‹ç™¼è€…åˆ†æ½¤</div></div>
  </div>
</section>

<div class="commission-bar">
  <h3>åˆ†äº«å›é¥‹åˆ¶åº¦</h3>
  <div class="split">
    <div class="split-item"><div class="pct">70%</div><div class="role">é–‹ç™¼è€…ï¼ˆå·¥å…·éŠ·å”®ï¼‰</div></div>
    <div class="split-item you"><div class="pct">15%</div><div class="role">æ¨è–¦åˆ†æ½¤ï¼ˆç¬¬ä¸€å¹´ï¼‰</div></div>
    <div class="split-item you"><div class="pct">10%</div><div class="role">æ¨è–¦åˆ†æ½¤ï¼ˆæŒçºŒï¼‰</div></div>
    <div class="split-item"><div class="pct">30%</div><div class="role">å¹³å°ï¼ˆå«é‡‘æµã€å®¢æœï¼‰</div></div>
  </div>
  <div style="text-align:center;color:#888;font-size:12px;margin-top:8px">é‡‘æµç”±ç¬¬ä¸‰æ–¹æ”¯ä»˜è™•ç†ï¼ˆç¶ ç•Œ/è—æ–°ï¼‰ãƒ»ä¾å°ç£æ¥­ç•Œæ¨™æº–</div>
</div>

<section class="search-section">
  <input type="text" class="search-box" id="searchBox" placeholder="æœå°‹ AI å·¥å…·... è‚¡ç¥¨ã€è¾²æ¥­ã€SEOã€å®¢æœ..." oninput="filterListings()">
  <button class="filter-btn active" onclick="setFilter('all', this)">å…¨éƒ¨</button>
  <button class="filter-btn" onclick="setFilter('featured', this)">ç²¾é¸</button>
  <div id="categoryBtns"></div>
</section>

<div class="grid" id="listingsGrid">
  <div style="text-align:center;padding:40px;color:#888;grid-column:1/-1">è¼‰å…¥ä¸­...</div>
</div>

<section class="create-section" id="earn">
  <h2>ä½ æœ‰ AI å·¥å…·ï¼Ÿ<span>åˆ†äº«çµ¦æ›´å¤šäºº</span></h2>
  <p>ä½ åšå·¥å…·ï¼Œæˆ‘å€‘å¹«ä½ æ‰¾åˆ°éœ€è¦çš„äºº â€” é–‹ç™¼è€…æ‹¿ 70%ï¼Œé‡‘æµç”±ç¬¬ä¸‰æ–¹è™•ç†ï¼Œé€æ˜å…¬é–‹ã€‚</p>
  <button class="create-btn" onclick="document.getElementById('createModal').classList.add('show')">ç«‹å³ä¸Šæ¶æˆ‘çš„ AI å·¥å…·</button>
</section>

<section class="how">
  <div class="how-card"><div class="step">1</div><h4>é¸å·¥å…·</h4><p>ç€è¦½å¸‚é›†ï¼Œæ‰¾åˆ°é©åˆä½ ç”¢æ¥­çš„ AI å·¥å…·</p></div>
  <div class="how-card"><div class="step">2</div><h4>é–‹å§‹ç”¨</h4><p>ä¸€éµå•Ÿç”¨ï¼ŒAI ç«‹åˆ»ç‚ºä½ å·¥ä½œ</p></div>
  <div class="how-card"><div class="step">3</div><h4>åˆ†äº«å¥½æ±è¥¿</h4><p>æ¨è–¦çµ¦æœ‹å‹ï¼Œåˆ†äº«å¥½å·¥å…·çµ¦éœ€è¦çš„äºº</p></div>
  <div class="how-card"><div class="step">4</div><h4>ä¸€èµ·æˆé•·</h4><p>å¹«åŠ©æ›´å¤šäººæ‰¾åˆ°å°çš„å·¥å…·ï¼Œä¸€èµ·èµ°å°çš„è·¯</p></div>
</section>

<section class="why-section">
  <h2>ç‚ºä»€éº¼åœ¨ SEOBAIKE <span>å¸‚é›†åˆ†äº«ï¼Ÿ</span></h2>
  <p>ä¸ç®¡ä½ æ˜¯å€‹äººé–‹ç™¼è€…é‚„æ˜¯å…¬å¸ï¼ŒæŠŠä½ çš„å¥½å·¥å…·åˆ†äº«çµ¦éœ€è¦çš„äººï¼Œå¹«åŠ©æ›´å¤šäººèµ°å°çš„è·¯</p>
  <div class="why-grid">
    <div class="why-card">
      <div class="why-icon">ğŸŒ</div>
      <h4>è§¸åŠå…¨å¹³å°ç”¨æˆ¶</h4>
      <p>ä½ çš„å·¥å…·ä¸Šæ¶å¾Œï¼ŒSEOBAIKE å…¨å¹³å°ç”¨æˆ¶éƒ½çœ‹å¾—åˆ°ã€‚ä¸ç”¨è‡ªå·±æ‰“å»£å‘Šï¼Œå¹³å°å¹«ä½ æ›å…‰</p>
      <div class="why-highlight">å…è²»æ›å…‰</div>
    </div>
    <div class="why-card">
      <div class="why-icon">âš¡</div>
      <h4>ç°¡å–®ä¸Šæ¶ï¼Œ15 åˆ†é˜æå®š</h4>
      <p>å¡«å€‹è¡¨æ ¼å°±ä¸Šæ¶äº†ï¼Œä¸ç”¨å¯«ç¨‹å¼ã€ä¸ç”¨æ¶ä¼ºæœå™¨ã€‚æœ‰ API ç«¯é»çš„è©±æ¥ä¸Šå°±å¥½ï¼Œæ²’æœ‰ä¹Ÿæ²’é—œä¿‚</p>
      <div class="why-highlight">15 åˆ†é˜</div>
    </div>
    <div class="why-card">
      <div class="why-icon">ğŸ’°</div>
      <h4>é€æ˜å…¬é–‹ï¼Œå³æ™‚è¿½è¹¤</h4>
      <p>é–‹ç™¼è€…æ‹¿ 70%ï¼Œé‡‘æµç”±ç¬¬ä¸‰æ–¹æ”¯ä»˜è™•ç†ã€‚åˆ†äº«æˆæœå³æ™‚é¡¯ç¤ºï¼Œå¹«äº†å¤šå°‘äººä¸€ç›®äº†ç„¶ã€‚</p>
      <div class="why-highlight">å³æ™‚è¿½è¹¤å„€è¡¨æ¿</div>
    </div>
  </div>
  <div class="why-cta">
    <button class="why-cta-btn" onclick="document.getElementById('createModal').classList.add('show')">åˆ†äº«ä½ çš„å¥½å·¥å…·</button>
  </div>
</section>

<div class="footer">
  SEOBAIKE â€” <a href="/">å°è·¯å…‰æœ‰é™å…¬å¸</a> â€” å¹«ä½ æ‰¾åˆ°å°çš„å·¥å…·
</div>

<!-- Create Modal -->
<div class="modal-overlay" id="createModal" onclick="if(event.target===this)this.classList.remove('show')">
  <div class="modal">
    <button class="close" onclick="this.closest('.modal-overlay').classList.remove('show')">&times;</button>
    <h2>ä¸€éµä¸Šæ¶ AI å·¥å…·</h2>
    <p style="color:#888;font-size:13px;margin-bottom:16px">å¡«å®Œé€å‡ºï¼Œè®“æ›´å¤šäººæ‰¾åˆ°ä½ çš„å¥½å·¥å…·ã€‚é–‹ç™¼è€…æ‹¿ 70%ï¼Œé‡‘æµç”±ç¬¬ä¸‰æ–¹è™•ç†ã€‚</p>
    <div class="modal-field"><label>å·¥å…·åç¨± *</label><input type="text" id="cr-title" placeholder="ä¾‹ï¼šAI è‚¡ç¥¨åˆ†æå¸«"></div>
    <div class="modal-field"><label>ä¸€å¥è©±ä»‹ç´¹</label><input type="text" id="cr-subtitle" placeholder="ä¾‹ï¼šå³æ™‚è‚¡åƒ¹é æ¸¬ + æŠ€è¡“åˆ†æ"></div>
    <div class="modal-field"><label>è©³ç´°èªªæ˜</label><textarea id="cr-desc" placeholder="é€™å€‹å·¥å…·èƒ½åšä»€éº¼ï¼Ÿå¹«ç”¨æˆ¶è§£æ±ºä»€éº¼å•é¡Œï¼Ÿ"></textarea></div>
    <div class="modal-field"><label>ç”¢æ¥­é¡åˆ¥</label><input type="text" id="cr-category" placeholder="ä¾‹ï¼šè‚¡ç¥¨ã€è¾²æ¥­ã€é¤é£²ã€æ•™è‚²..."></div>
    <div class="modal-field"><label>åœ–ç¤º Emoji</label><input type="text" id="cr-icon" placeholder="ğŸ¤–" value="ğŸ¤–" maxlength="4"></div>
    <div class="modal-field"><label>å®šåƒ¹ï¼ˆTWD/æœˆï¼Œ0=å…è²»ï¼‰</label><input type="number" id="cr-price" value="0" min="0"></div>
    <div class="modal-field">
      <label>è¨ˆè²»æ–¹å¼</label>
      <select id="cr-pricing"><option value="free">å…è²»</option><option value="monthly">æœˆè¨‚é–±</option><option value="one_time">ä¸€æ¬¡æ€§</option><option value="per_use">æŒ‰æ¬¡è¨ˆè²»</option></select>
    </div>
    <div class="modal-field"><label>API ç«¯é»ï¼ˆé¸å¡«ï¼‰</label><input type="text" id="cr-endpoint" placeholder="/api/ai/analyze"></div>
    <button class="modal-submit" onclick="submitListing()">é€å‡ºä¸Šæ¶</button>
    <div id="cr-result" style="margin-top:12px;font-size:14px;display:none"></div>
  </div>
</div>

<script src="/seobaike-config.js"></script>
<script>
const API = window.location.origin;
let allListings = [];
let currentFilter = 'all';

async function loadMarketplace() {
  try {
    const res = await fetch(API + '/api/marketplace');
    const data = await res.json();
    allListings = data.listings || [];

    document.getElementById('stat-listings').textContent = allListings.length;
    document.getElementById('stat-users').textContent = allListings.reduce((s, l) => s + (l.total_users || 0), 0).toLocaleString();
    document.getElementById('stat-categories').textContent = (data.categories || []).length;

    // Category buttons
    const cats = data.categories || [];
    document.getElementById('categoryBtns').innerHTML = cats.slice(0, 8).map(c =>
      '<button class="filter-btn" onclick="setFilter(\'' + c + '\', this)">' + c + '</button>'
    ).join('');

    renderListings(allListings);
  } catch(e) {
    document.getElementById('listingsGrid').innerHTML = '<div style="text-align:center;padding:40px;color:#ff6b6b;grid-column:1/-1">è¼‰å…¥å¤±æ•—ï¼š' + e.message + '</div>';
  }
}

function renderListings(items) {
  if (!items.length) {
    document.getElementById('listingsGrid').innerHTML = '<div style="text-align:center;padding:40px;color:#888;grid-column:1/-1">æ²’æœ‰ç¬¦åˆçš„å·¥å…·</div>';
    return;
  }
  document.getElementById('listingsGrid').innerHTML = items.map(l => {
    const priceText = l.price_twd === 0 ? 'å…è²»' : 'NT$ ' + l.price_twd.toLocaleString() + (l.pricing_model === 'monthly' ? '/æœˆ' : l.pricing_model === 'per_use' ? '/æ¬¡' : '');
    const stars = l.avg_rating ? 'â˜… ' + Number(l.avg_rating).toFixed(1) : '';
    const tags = (l.tags || []).slice(0, 3);
    return '<div class="card" onclick="showDetail(\'' + l.id + '\')">' +
      (l.featured ? '<div class="card-badge">ç²¾é¸</div>' : '') +
      '<div class="card-head"><div class="card-icon">' + (l.icon || 'ğŸ¤–') + '</div><div class="card-info"><h3>' + esc(l.title) + '</h3><div class="sub">' + esc(l.subtitle || l.category || '') + '</div></div></div>' +
      '<div class="card-body"><p>' + esc(l.description || '') + '</p></div>' +
      '<div class="card-tags">' + tags.map(t => '<span class="tag">' + esc(t) + '</span>').join('') + '</div>' +
      '<div class="card-foot"><div class="price' + (l.price_twd === 0 ? ' free' : '') + '">' + priceText + '</div><div class="stats"><span>' + stars + '</span><span>' + (l.total_users || 0).toLocaleString() + ' äººç”¨</span></div></div>' +
      '</div>';
  }).join('');
}

function filterListings() {
  const q = document.getElementById('searchBox').value.toLowerCase();
  let filtered = allListings;
  if (currentFilter === 'featured') filtered = filtered.filter(l => l.featured);
  else if (currentFilter !== 'all') filtered = filtered.filter(l => l.category === currentFilter);
  if (q) filtered = filtered.filter(l => (l.title + l.description + l.category + (l.tags || []).join(' ')).toLowerCase().includes(q));
  renderListings(filtered);
}

function setFilter(f, btn) {
  currentFilter = f;
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  if (btn) btn.classList.add('active');
  filterListings();
}

function showDetail(id) {
  const l = allListings.find(x => x.id === id);
  if (!l) return;
  const priceText = l.price_twd === 0 ? 'å…è²»' : 'NT$ ' + l.price_twd.toLocaleString();
  const shareUrl = window.location.origin + '/marketplace?tool=' + id;
  alert(l.icon + ' ' + l.title + '\n\n' + (l.description || '') + '\n\nåƒ¹æ ¼ï¼š' + priceText + '\nç”¨æˆ¶ï¼š' + (l.total_users || 0).toLocaleString() + ' äºº\nè©•åˆ†ï¼š' + (l.avg_rating || 'N/A') + '\n\nåˆ†äº«é€£çµï¼ˆæ¨è–¦è³º 15%ï¼‰ï¼š\n' + shareUrl);
}

async function submitListing() {
  const title = document.getElementById('cr-title').value.trim();
  if (!title) { alert('è«‹è¼¸å…¥å·¥å…·åç¨±'); return; }
  const body = {
    title,
    subtitle: document.getElementById('cr-subtitle').value.trim(),
    description: document.getElementById('cr-desc').value.trim(),
    category: document.getElementById('cr-category').value.trim(),
    icon: document.getElementById('cr-icon').value.trim() || 'ğŸ¤–',
    price_twd: parseInt(document.getElementById('cr-price').value) || 0,
    pricing_model: document.getElementById('cr-pricing').value,
    api_endpoint: document.getElementById('cr-endpoint').value.trim(),
  };
  const resultDiv = document.getElementById('cr-result');
  resultDiv.style.display = 'block';
  resultDiv.style.color = '#e8850c';
  resultDiv.textContent = 'ä¸Šæ¶ä¸­...';
  try {
    const res = await fetch(API + '/api/marketplace/create', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(body),
    });
    const data = await res.json();
    if (data.success) {
      resultDiv.style.color = '#76b900';
      resultDiv.textContent = 'ä¸Šæ¶æˆåŠŸï¼ä½ çš„å·¥å…·å·²å‡ºç¾åœ¨å¸‚é›†ä¸Šã€‚';
      setTimeout(() => { document.getElementById('createModal').classList.remove('show'); loadMarketplace(); }, 2000);
    } else {
      resultDiv.style.color = '#ff6b6b';
      resultDiv.textContent = 'ä¸Šæ¶å¤±æ•—ï¼š' + (data.error || JSON.stringify(data));
    }
  } catch(e) {
    resultDiv.style.color = '#ff6b6b';
    resultDiv.textContent = 'éŒ¯èª¤ï¼š' + e.message;
  }
}

function esc(s) { return String(s||'').replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/"/g,'&quot;'); }

// Track page view
fetch(window.__SEOBAIKE__?.supabaseUrl + '/rest/v1/page_views', {
  method: 'POST', headers: { 'Content-Type': 'application/json', 'apikey': window.__SEOBAIKE__?.anonKey, 'Authorization': 'Bearer ' + window.__SEOBAIKE__?.anonKey, 'Prefer': 'return=minimal' },
  body: JSON.stringify({ path: '/marketplace', referrer: document.referrer || null, user_agent: navigator.userAgent, country: null })
}).catch(() => {});

loadMarketplace();
</script>
</body>
</html>
