<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>SEOBAIKE Command Center | Patent 115100981</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&family=JetBrains+Mono:wght@400;500;600;700&display=swap" rel="stylesheet">
<style>
:root{--bg:#05060f;--card:rgba(12,14,28,0.85);--border:rgba(255,255,255,0.06);--red:#ff3b3b;--green:#00e676;--gold:#ffd740;--blue:#448aff;--orange:#ff9100;--cyan:#00e5ff;--purple:#b388ff}
*{margin:0;padding:0;box-sizing:border-box}
html{scroll-behavior:smooth}
body{background:var(--bg);color:#e0e0e0;font-family:'Inter',system-ui,sans-serif;min-height:100vh;overflow-x:hidden}
::-webkit-scrollbar{width:5px}::-webkit-scrollbar-track{background:transparent}::-webkit-scrollbar-thumb{background:rgba(255,59,59,0.4);border-radius:10px}

/* Particle canvas background */
#particles{position:fixed;top:0;left:0;width:100%;height:100%;z-index:0;pointer-events:none}

/* Scan line */
.scanline{position:fixed;top:0;left:0;width:100%;height:3px;background:linear-gradient(90deg,transparent,rgba(0,230,118,0.4),transparent);z-index:2;pointer-events:none;animation:scanDown 4s linear infinite}
@keyframes scanDown{0%{top:0;opacity:0}5%{opacity:1}95%{opacity:1}100%{top:100vh;opacity:0}}

.container{position:relative;z-index:1;max-width:1600px;margin:0 auto}

/* TOP BAR */
.topbar{background:rgba(5,6,15,0.95);backdrop-filter:blur(20px);border-bottom:1px solid rgba(255,59,59,0.3);padding:0 24px;height:56px;display:flex;align-items:center;justify-content:space-between;position:sticky;top:0;z-index:1000}
.topbar-left{display:flex;align-items:center;gap:16px}
.logo-mark{width:32px;height:32px;background:linear-gradient(135deg,var(--red),#ff6b3b);border-radius:8px;display:flex;align-items:center;justify-content:center;font-weight:900;font-size:14px;color:#fff;box-shadow:0 0 20px rgba(255,59,59,0.3);animation:logoPulse 3s ease-in-out infinite}
@keyframes logoPulse{0%,100%{box-shadow:0 0 20px rgba(255,59,59,0.3)}50%{box-shadow:0 0 40px rgba(255,59,59,0.6),0 0 80px rgba(255,59,59,0.2)}}
.logo-text{font-family:'JetBrains Mono',monospace;font-weight:700;font-size:14px;color:#fff;letter-spacing:1px}
.logo-text span{color:var(--red)}
.topbar-right{display:flex;align-items:center;gap:16px}
.live-dot{width:8px;height:8px;border-radius:50%;background:var(--green);box-shadow:0 0 12px var(--green);animation:livePulse 2s ease-in-out infinite}
@keyframes livePulse{0%,100%{box-shadow:0 0 12px var(--green)}50%{box-shadow:0 0 24px var(--green),0 0 48px rgba(0,230,118,0.3)}}
.live-label{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--green);font-weight:600;letter-spacing:2px}
.clock{font-family:'JetBrains Mono',monospace;font-size:12px;color:rgba(255,255,255,0.5)}

/* TICKER - scrolling data feed */
.ticker-wrap{background:rgba(0,0,0,0.4);border-bottom:1px solid var(--border);overflow:hidden;height:28px;position:relative}
.ticker{display:flex;animation:tickerScroll 30s linear infinite;white-space:nowrap;align-items:center;height:28px}
.ticker-item{display:inline-flex;align-items:center;gap:6px;padding:0 24px;font-family:'JetBrains Mono',monospace;font-size:11px;color:rgba(255,255,255,0.4)}
.ticker-item .dot{width:4px;height:4px;border-radius:50%}
@keyframes tickerScroll{0%{transform:translateX(0)}100%{transform:translateX(-50%)}}

/* COMMANDER HEADER */
.cmd-header{background:linear-gradient(180deg,rgba(255,59,59,0.08) 0%,transparent 100%);padding:32px 24px 24px;text-align:center;position:relative}
.cmd-header::after{content:'';position:absolute;bottom:0;left:10%;right:10%;height:1px;background:linear-gradient(90deg,transparent,rgba(255,59,59,0.3),transparent)}
.cmd-title{font-size:28px;font-weight:900;letter-spacing:4px;background:linear-gradient(135deg,#fff,#ffd740,#ff9100);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;margin-bottom:8px;animation:titleGlow 4s ease-in-out infinite}
@keyframes titleGlow{0%,100%{filter:brightness(1)}50%{filter:brightness(1.3)}}
.cmd-sub{font-size:13px;color:rgba(255,255,255,0.5);font-weight:400;letter-spacing:1px}
.cmd-patent{display:inline-block;margin-top:10px;padding:4px 16px;border:1px solid rgba(255,215,64,0.3);border-radius:20px;font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--gold);letter-spacing:1px;background:rgba(255,215,64,0.05);animation:patentPulse 3s ease-in-out infinite}
@keyframes patentPulse{0%,100%{border-color:rgba(255,215,64,0.3);box-shadow:none}50%{border-color:rgba(255,215,64,0.6);box-shadow:0 0 20px rgba(255,215,64,0.1)}}

/* PROGRESS */
.progress-wrap{padding:20px 24px;background:rgba(0,0,0,0.2)}
.progress-top{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.progress-label{font-size:12px;font-weight:600;letter-spacing:2px;color:rgba(255,255,255,0.4);text-transform:uppercase}
.progress-value{font-family:'JetBrains Mono',monospace;font-size:24px;font-weight:800;color:#fff}
.progress-bar{height:6px;background:rgba(255,255,255,0.06);border-radius:3px;overflow:hidden;position:relative}
.progress-fill{height:100%;border-radius:3px;transition:width 1s cubic-bezier(0.4,0,0.2,1);position:relative}
.progress-fill::after{content:'';position:absolute;top:0;left:0;width:200px;height:100%;background:linear-gradient(90deg,transparent,rgba(255,255,255,0.3),transparent);animation:progressShimmer 2s linear infinite}
@keyframes progressShimmer{0%{transform:translateX(-200px)}100%{transform:translateX(1600px)}}

/* NAV TABS */
.nav-tabs{display:flex;gap:4px;padding:12px 24px;background:rgba(0,0,0,0.3);border-bottom:1px solid var(--border);overflow-x:auto;-webkit-overflow-scrolling:touch}
.nav-tabs::-webkit-scrollbar{display:none}
.tab{padding:8px 20px;border-radius:8px;font-size:12px;font-weight:600;letter-spacing:1px;color:rgba(255,255,255,0.4);background:transparent;border:1px solid transparent;cursor:pointer;transition:all 0.3s;white-space:nowrap;font-family:'Inter',sans-serif}
.tab:hover{color:rgba(255,255,255,0.7);background:rgba(255,255,255,0.03)}
.tab.active{color:#fff;background:rgba(255,59,59,0.15);border-color:rgba(255,59,59,0.3);box-shadow:0 0 20px rgba(255,59,59,0.1)}

/* QUICK LINKS */
.quick-links{display:flex;gap:8px;padding:12px 24px;flex-wrap:wrap}
.qlink{display:flex;align-items:center;gap:6px;padding:8px 16px;border-radius:8px;font-size:12px;font-weight:600;color:#fff;text-decoration:none;transition:all 0.3s;border:1px solid transparent}
.qlink:hover{transform:translateY(-2px);box-shadow:0 4px 16px rgba(0,0,0,0.3)}
.qlink.grok{background:linear-gradient(135deg,rgba(255,59,59,0.2),rgba(255,59,59,0.1));border-color:rgba(255,59,59,0.3)}
.qlink.sb{background:linear-gradient(135deg,rgba(62,207,142,0.2),rgba(62,207,142,0.1));border-color:rgba(62,207,142,0.3)}
.qlink.tg{background:linear-gradient(135deg,rgba(0,136,204,0.2),rgba(0,136,204,0.1));border-color:rgba(0,136,204,0.3)}
.qlink.az{background:linear-gradient(135deg,rgba(0,120,212,0.2),rgba(0,120,212,0.1));border-color:rgba(0,120,212,0.3)}
.qlink-dot{width:6px;height:6px;border-radius:50%;animation:qlinkBlink 2s ease-in-out infinite}
.qlink.grok .qlink-dot{background:var(--red)}.qlink.sb .qlink-dot{background:#3ecf8e}.qlink.tg .qlink-dot{background:#0088cc}.qlink.az .qlink-dot{background:#0078d4}
@keyframes qlinkBlink{0%,100%{opacity:1}50%{opacity:0.3}}

/* ALERT */
.alert{display:none;margin:12px 24px;padding:12px 20px;border-radius:10px;border:1px solid rgba(255,59,59,0.4);background:rgba(255,59,59,0.08);color:var(--red);font-size:13px;font-weight:600;text-align:center}
.alert.show{display:block;animation:alertFlash 2s ease-in-out infinite}
@keyframes alertFlash{0%,100%{background:rgba(255,59,59,0.08);box-shadow:none}50%{background:rgba(255,59,59,0.15);box-shadow:0 0 30px rgba(255,59,59,0.2)}}

/* LIVE LOG */
.live-log{background:rgba(0,0,0,0.3);border-top:1px solid var(--border);padding:8px 24px;font-family:'JetBrains Mono',monospace;font-size:10px;color:rgba(255,255,255,0.25);height:80px;overflow:hidden;position:relative}
.live-log::after{content:'';position:absolute;top:0;left:0;right:0;height:20px;background:linear-gradient(rgba(5,6,15,1),transparent);pointer-events:none}
.log-line{padding:1px 0;animation:logFadeIn 0.5s ease-out}
@keyframes logFadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
.log-time{color:rgba(255,255,255,0.15)}
.log-ok{color:var(--green)}.log-err{color:var(--red)}.log-warn{color:var(--gold)}.log-info{color:var(--blue)}

/* MAIN GRID */
.main{padding:16px 24px;display:grid;grid-template-columns:repeat(12,1fr);gap:16px}

/* CARDS with entrance animation */
.card{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:20px;backdrop-filter:blur(10px);transition:all 0.3s;animation:cardIn 0.6s ease-out both}
@keyframes cardIn{from{opacity:0;transform:translateY(20px)}to{opacity:1;transform:translateY(0)}}
.card:nth-child(1){animation-delay:0.05s}.card:nth-child(2){animation-delay:0.1s}.card:nth-child(3){animation-delay:0.15s}.card:nth-child(4){animation-delay:0.2s}.card:nth-child(5){animation-delay:0.25s}
.card:hover{border-color:rgba(255,255,255,0.1);box-shadow:0 8px 32px rgba(0,0,0,0.3)}
.card.danger{border-color:rgba(255,59,59,0.3);box-shadow:0 0 40px rgba(255,59,59,0.15)}
.card.ok{border-color:rgba(0,230,118,0.15)}
.c-4{grid-column:span 4}.c-6{grid-column:span 6}.c-8{grid-column:span 8}.c-12{grid-column:span 12}
@media(max-width:1200px){.c-4,.c-6,.c-8{grid-column:span 6}}
@media(max-width:768px){.c-4,.c-6,.c-8,.c-12{grid-column:span 12}}

.card-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}
.card-title{font-size:11px;font-weight:700;letter-spacing:2px;color:rgba(255,255,255,0.4);text-transform:uppercase}
.badge{font-family:'JetBrains Mono',monospace;font-size:10px;font-weight:700;padding:3px 10px;border-radius:6px;letter-spacing:1px}
.badge.g{background:rgba(0,230,118,0.1);color:var(--green);border:1px solid rgba(0,230,118,0.2)}
.badge.r{background:rgba(255,59,59,0.1);color:var(--red);border:1px solid rgba(255,59,59,0.2);animation:badgePulse 2s infinite}
.badge.y{background:rgba(255,215,64,0.1);color:var(--gold);border:1px solid rgba(255,215,64,0.2)}
.badge.b{background:rgba(68,138,255,0.1);color:var(--blue);border:1px solid rgba(68,138,255,0.2)}
@keyframes badgePulse{0%,100%{opacity:1}50%{opacity:0.5}}

/* Stat rows */
.stat-row{display:flex;justify-content:space-between;align-items:center;padding:8px 0;border-bottom:1px solid rgba(255,255,255,0.03)}
.stat-row:last-child{border:none}
.stat-label{font-size:13px;color:rgba(255,255,255,0.45)}
.stat-val{font-family:'JetBrains Mono',monospace;font-size:13px;font-weight:600}
.stat-val.g{color:var(--green)}.stat-val.r{color:var(--red)}.stat-val.y{color:var(--gold)}.stat-val.w{color:#fff}

/* RADAR */
.radar-wrap{width:200px;height:200px;margin:0 auto;position:relative}
.radar-svg{width:100%;height:100%}
.radar-sweep{transform-origin:100px 100px;animation:radarSweep 3s linear infinite}
@keyframes radarSweep{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
.radar-dot{animation:radarDotPulse 3s ease-in-out infinite}
@keyframes radarDotPulse{0%,100%{opacity:0.3;r:3}50%{opacity:1;r:5}}

/* PHYSICAL AI */
.pai-section{grid-column:span 12;background:linear-gradient(135deg,rgba(12,14,28,0.9),rgba(20,10,40,0.9));border:1px solid rgba(179,136,255,0.2);border-radius:14px;padding:24px;position:relative;overflow:hidden}
.pai-section::before{content:'';position:absolute;top:-50%;right:-20%;width:400px;height:400px;background:radial-gradient(circle,rgba(179,136,255,0.08),transparent 70%);pointer-events:none;animation:paiOrb 8s ease-in-out infinite}
@keyframes paiOrb{0%,100%{transform:translate(0,0)}50%{transform:translate(-60px,40px)}}
.pai-head{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}
.pai-title{font-size:18px;font-weight:800;background:linear-gradient(135deg,#b388ff,#7c4dff,#448aff);-webkit-background-clip:text;-webkit-text-fill-color:transparent;background-clip:text;letter-spacing:1px}
.pai-grid{display:grid;grid-template-columns:repeat(4,1fr);gap:12px}
@media(max-width:900px){.pai-grid{grid-template-columns:repeat(2,1fr)}}
@media(max-width:500px){.pai-grid{grid-template-columns:1fr}}
.pai-card{background:rgba(179,136,255,0.05);border:1px solid rgba(179,136,255,0.1);border-radius:10px;padding:16px;text-align:center;transition:all 0.3s;position:relative;overflow:hidden}
.pai-card:hover{border-color:rgba(179,136,255,0.3);transform:translateY(-2px)}
.pai-card::after{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:conic-gradient(transparent,transparent,transparent,rgba(179,136,255,0.05));animation:paiCardSpin 6s linear infinite}
@keyframes paiCardSpin{to{transform:rotate(360deg)}}
.pai-layer{font-family:'JetBrains Mono',monospace;font-size:20px;font-weight:800;margin-bottom:6px;position:relative;z-index:1}
.pai-layer.l1{color:#00e5ff}.pai-layer.l2{color:var(--green)}.pai-layer.l3{color:var(--gold)}.pai-layer.l4{color:var(--red)}
.pai-name{font-size:12px;font-weight:600;color:rgba(255,255,255,0.7);margin-bottom:8px;position:relative;z-index:1}
.pai-desc{font-size:11px;color:rgba(255,255,255,0.35);line-height:1.5;position:relative;z-index:1}
.pai-status{margin-top:8px;font-family:'JetBrains Mono',monospace;font-size:10px;font-weight:700;padding:3px 8px;border-radius:4px;display:inline-block;position:relative;z-index:1}
.pai-status.live{background:rgba(0,230,118,0.1);color:var(--green);border:1px solid rgba(0,230,118,0.2)}

/* Constraint flow with animation */
.constraint-flow{margin-top:20px;padding:16px;background:rgba(0,0,0,0.2);border-radius:10px;border:1px solid rgba(255,255,255,0.03);overflow-x:auto}
.flow-title{font-size:11px;font-weight:700;letter-spacing:2px;color:rgba(255,255,255,0.3);margin-bottom:12px;text-transform:uppercase}
.flow-line{display:flex;align-items:center;gap:8px;padding:6px 0;font-size:12px;flex-wrap:wrap}
.flow-arrow{color:rgba(179,136,255,0.5);font-family:'JetBrains Mono',monospace;animation:arrowPulse 1.5s ease-in-out infinite}
@keyframes arrowPulse{0%,100%{opacity:0.3}50%{opacity:1}}
.flow-node{padding:4px 12px;border-radius:6px;font-family:'JetBrains Mono',monospace;font-size:11px;font-weight:600;animation:nodeGlow 3s ease-in-out infinite}
.flow-node:nth-child(1){animation-delay:0s}.flow-node:nth-child(3){animation-delay:0.4s}.flow-node:nth-child(5){animation-delay:0.8s}.flow-node:nth-child(7){animation-delay:1.2s}.flow-node:nth-child(9){animation-delay:1.6s}.flow-node:nth-child(11){animation-delay:2s}.flow-node:nth-child(13){animation-delay:2.4s}
@keyframes nodeGlow{0%,100%{filter:brightness(1)}50%{filter:brightness(1.4)}}
.flow-node.input{background:rgba(0,229,255,0.1);color:var(--cyan);border:1px solid rgba(0,229,255,0.2)}
.flow-node.process{background:rgba(179,136,255,0.1);color:var(--purple);border:1px solid rgba(179,136,255,0.2)}
.flow-node.output{background:rgba(0,230,118,0.1);color:var(--green);border:1px solid rgba(0,230,118,0.2)}
.flow-node.constraint{background:rgba(255,59,59,0.1);color:var(--red);border:1px solid rgba(255,59,59,0.2)}

/* Data pulse effect running through pipeline */
.flow-pulse{position:absolute;width:8px;height:8px;border-radius:50%;background:var(--cyan);box-shadow:0 0 10px var(--cyan);animation:flowPulse 3s linear infinite;pointer-events:none}
@keyframes flowPulse{0%{left:0;opacity:1}100%{left:100%;opacity:0}}

/* SOLDIER CARDS */
.soldier-grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:10px}
.soldier{background:rgba(255,255,255,0.02);border:1px solid rgba(255,255,255,0.05);border-radius:10px;padding:14px;transition:all 0.3s;position:relative;overflow:hidden;animation:soldierIn 0.4s ease-out both}
.soldier:nth-child(1){animation-delay:0.05s}.soldier:nth-child(2){animation-delay:0.1s}.soldier:nth-child(3){animation-delay:0.15s}.soldier:nth-child(4){animation-delay:0.2s}.soldier:nth-child(5){animation-delay:0.25s}.soldier:nth-child(6){animation-delay:0.3s}.soldier:nth-child(7){animation-delay:0.35s}.soldier:nth-child(8){animation-delay:0.4s}.soldier:nth-child(9){animation-delay:0.45s}.soldier:nth-child(10){animation-delay:0.5s}
@keyframes soldierIn{from{opacity:0;transform:scale(0.9)}to{opacity:1;transform:scale(1)}}
.soldier:hover{border-color:rgba(255,255,255,0.1);transform:translateY(-2px)}
.soldier.dead{border-color:rgba(255,59,59,0.3);background:rgba(255,59,59,0.03)}
.soldier.dead::before{content:'';position:absolute;top:0;left:0;right:0;height:2px;background:var(--red);animation:deadPulse 1.5s infinite}
@keyframes deadPulse{0%,100%{opacity:0.3}50%{opacity:1}}
/* Activity indicator for online soldiers */
.soldier.online::after{content:'';position:absolute;bottom:0;left:0;right:0;height:1px;background:linear-gradient(90deg,transparent,var(--green),transparent);animation:onlineSlide 2s linear infinite}
@keyframes onlineSlide{0%{transform:translateX(-100%)}100%{transform:translateX(100%)}}
.s-top{display:flex;justify-content:space-between;align-items:flex-start;margin-bottom:8px}
.s-name{font-size:13px;font-weight:700;color:#fff}
.s-model{font-size:10px;color:rgba(255,255,255,0.3);margin-top:2px;font-family:'JetBrains Mono',monospace}
.s-tag{font-family:'JetBrains Mono',monospace;font-size:9px;font-weight:700;padding:2px 8px;border-radius:4px;letter-spacing:1px}
.s-tag.on{background:rgba(0,230,118,0.1);color:var(--green);border:1px solid rgba(0,230,118,0.2)}
.s-tag.off{background:rgba(255,59,59,0.1);color:var(--red);border:1px solid rgba(255,59,59,0.2);animation:badgePulse 1.5s infinite}
.s-bar{height:3px;background:rgba(255,255,255,0.04);border-radius:2px;margin-top:8px;overflow:hidden}
.s-bar-fill{height:100%;border-radius:2px;transition:width 0.8s}
.s-meta{display:flex;justify-content:space-between;margin-top:6px;font-size:10px;color:rgba(255,255,255,0.3);font-family:'JetBrains Mono',monospace}
.cost-low{color:var(--green)}.cost-medium{color:var(--gold)}.cost-high{color:var(--orange)}.cost-very_high{color:var(--red)}

/* APP ROWS */
.app-item{display:flex;align-items:center;gap:12px;padding:12px;background:rgba(255,255,255,0.02);border-radius:8px;margin-bottom:6px;transition:all 0.3s}
.app-item:hover{background:rgba(255,255,255,0.04);transform:translateX(4px)}
.app-dot{width:8px;height:8px;border-radius:50%;flex-shrink:0}
.app-dot.on{background:var(--green);box-shadow:0 0 8px var(--green);animation:livePulse 2s infinite}
.app-dot.off{background:var(--red);box-shadow:0 0 8px var(--red);animation:badgePulse 1.5s infinite}
.app-name{flex:1;font-size:13px;font-weight:600;color:#fff}
.app-ms{font-family:'JetBrains Mono',monospace;font-size:12px;min-width:60px;text-align:right}
.app-cost{font-size:11px;color:rgba(255,255,255,0.3);min-width:80px;text-align:right}

/* HEARTBEAT */
.hb-item{display:flex;align-items:center;gap:8px;padding:6px 0;font-size:12px;border-bottom:1px solid rgba(255,255,255,0.03)}
.hb-item:last-child{border:none}
.hb-dot{width:6px;height:6px;border-radius:50%;animation:hbDot 1.5s ease-in-out infinite}
@keyframes hbDot{0%,100%{transform:scale(1)}50%{transform:scale(1.5)}}
.hb-name{flex:1;color:rgba(255,255,255,0.6)}
.hb-time{font-family:'JetBrains Mono',monospace;font-size:10px;color:rgba(255,255,255,0.25)}

/* ENDPOINTS */
.ep-item{display:flex;align-items:center;gap:12px;padding:10px;background:rgba(255,255,255,0.02);border-radius:8px;margin-bottom:6px;transition:all 0.3s}
.ep-item:hover{background:rgba(255,255,255,0.04);transform:translateX(4px)}
.ep-name{font-size:12px;font-weight:600;color:rgba(255,255,255,0.7);min-width:140px}
.ep-url{font-family:'JetBrains Mono',monospace;font-size:11px;color:var(--blue);text-decoration:none;word-break:break-all}
.ep-url:hover{color:var(--cyan)}

/* MEETING */
.meeting-box{padding:20px;text-align:center}
.meeting-btn{background:linear-gradient(135deg,var(--red),#ff6b3b);color:#fff;border:none;padding:14px 32px;border-radius:10px;font-size:14px;font-weight:700;cursor:pointer;letter-spacing:1px;transition:all 0.3s;font-family:'Inter',sans-serif;position:relative;overflow:hidden}
.meeting-btn::after{content:'';position:absolute;top:-50%;left:-50%;width:200%;height:200%;background:conic-gradient(transparent,transparent,transparent,rgba(255,255,255,0.1));animation:btnSpin 3s linear infinite}
@keyframes btnSpin{to{transform:rotate(360deg)}}
.meeting-btn:hover{transform:translateY(-2px);box-shadow:0 8px 24px rgba(255,59,59,0.3)}
.meeting-result{margin-top:20px;text-align:left;font-size:13px;line-height:1.8;white-space:pre-wrap;color:rgba(255,255,255,0.7)}

/* LOADING */
.loading{text-align:center;padding:80px 24px}
.loading-ring{width:40px;height:40px;border:3px solid rgba(255,59,59,0.1);border-top-color:var(--red);border-radius:50%;animation:spin 1s linear infinite;margin:0 auto 16px}
@keyframes spin{to{transform:rotate(360deg)}}
.loading-text{font-size:13px;color:rgba(255,255,255,0.3);letter-spacing:2px}

/* FOOTER */
.footer{text-align:center;padding:24px;color:rgba(255,255,255,0.15);font-size:11px;letter-spacing:1px}

/* Metric ring */
.metric-ring{position:relative;width:80px;height:80px;margin:0 auto 12px}
.metric-ring svg{transform:rotate(-90deg)}
.metric-ring circle{fill:none;stroke-width:4}
.metric-ring .bg{stroke:rgba(255,255,255,0.05)}
.metric-ring .fg{stroke-linecap:round;transition:stroke-dashoffset 1s}
.metric-num{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);font-family:'JetBrains Mono',monospace;font-size:18px;font-weight:800;color:#fff}
.metric-label{text-align:center;font-size:11px;color:rgba(255,255,255,0.35);font-weight:500}
.metrics-row{display:flex;gap:16px;justify-content:space-around;margin-bottom:20px;flex-wrap:wrap}

/* Animated number counter */
.counter{display:inline-block;transition:all 0.5s}
</style>
</head>
<body>

<!-- Particle canvas -->
<canvas id="particles"></canvas>
<!-- Scan line -->
<div class="scanline"></div>

<div class="container">

<!-- TOP BAR -->
<div class="topbar">
  <div class="topbar-left">
    <div class="logo-mark">S</div>
    <div class="logo-text">SEO<span>BAIKE</span> COMMAND CENTER</div>
  </div>
  <div class="topbar-right">
    <div class="live-dot"></div>
    <span class="live-label">LIVE</span>
    <span class="clock" id="clock"></span>
  </div>
</div>

<!-- SCROLLING TICKER -->
<div class="ticker-wrap">
  <div class="ticker" id="ticker"></div>
</div>

<!-- COMMANDER HEADER -->
<div class="cmd-header">
  <div class="cmd-title">指揮官：許竣翔</div>
  <div class="cmd-sub">CEO, 小路光有限公司 &bull; 統編 60475510 &bull; SEOBAIKE AI Platform</div>
  <div class="cmd-patent">Patent 115100981 — 世界定義約束法用於AI推理 — CaaS</div>
</div>

<!-- PROGRESS -->
<div class="progress-wrap">
  <div class="progress-top">
    <span class="progress-label">System Progress</span>
    <span class="progress-value" id="pctVal">--</span>
  </div>
  <div class="progress-bar">
    <div class="progress-fill" id="pbar" style="width:0%"></div>
  </div>
</div>

<!-- NAV -->
<div class="nav-tabs">
  <button class="tab active" onclick="switchView('war',this)">WAR ROOM</button>
  <button class="tab" onclick="switchView('physics',this)">PHYSICAL AI</button>
  <button class="tab" onclick="switchView('models',this)">AI SOLDIERS</button>
  <button class="tab" onclick="switchView('azure',this)">AZURE</button>
  <button class="tab" onclick="switchView('meeting',this)">MEETING</button>
  <button class="tab" onclick="switchView('endpoints',this)">ENDPOINTS</button>
</div>

<!-- QUICK LINKS -->
<div class="quick-links">
  <a href="https://grok.com" target="_blank" class="qlink grok"><span class="qlink-dot"></span>GROK AI</a>
  <a href="https://supabase.com/dashboard/project/vmyrivxxibqydccurxug" target="_blank" class="qlink sb"><span class="qlink-dot"></span>SUPABASE</a>
  <a href="https://t.me/seobaike_bot" target="_blank" class="qlink tg"><span class="qlink-dot"></span>TELEGRAM</a>
  <a href="https://portal.azure.com" target="_blank" class="qlink az"><span class="qlink-dot"></span>AZURE</a>
</div>

<div class="alert" id="alertBanner"></div>

<!-- CONTENT -->
<div id="content"><div class="loading"><div class="loading-ring"></div><div class="loading-text">LOADING WAR ROOM DATA...</div></div></div>

<!-- LIVE LOG -->
<div class="live-log" id="liveLog"></div>

<!-- FOOTER -->
<div class="footer">SEOBAIKE AI Platform &bull; Patent 115100981 &bull; aiforseo.vip &bull; Auto-refresh 15s</div>

</div>

<script>
const API='https://grok-takeover-app.azurewebsites.net/api/commander';
let currentView='war',cachedData=null;

// === PARTICLE SYSTEM ===
const canvas=document.getElementById('particles');
const ctx=canvas.getContext('2d');
let particles=[];
function resizeCanvas(){canvas.width=window.innerWidth;canvas.height=window.innerHeight}
window.addEventListener('resize',resizeCanvas);resizeCanvas();

class Particle{
  constructor(){this.reset()}
  reset(){
    this.x=Math.random()*canvas.width;
    this.y=Math.random()*canvas.height;
    this.vx=(Math.random()-0.5)*0.3;
    this.vy=(Math.random()-0.5)*0.3;
    this.size=Math.random()*2+0.5;
    this.alpha=Math.random()*0.3+0.05;
    this.color=['255,59,59','0,230,118','68,138,255','255,215,64','0,229,255'][Math.floor(Math.random()*5)];
  }
  update(){
    this.x+=this.vx;this.y+=this.vy;
    if(this.x<0||this.x>canvas.width||this.y<0||this.y>canvas.height)this.reset();
  }
  draw(){
    ctx.beginPath();
    ctx.arc(this.x,this.y,this.size,0,Math.PI*2);
    ctx.fillStyle=`rgba(${this.color},${this.alpha})`;
    ctx.fill();
  }
}
for(let i=0;i<80;i++)particles.push(new Particle());

function drawConnections(){
  for(let i=0;i<particles.length;i++){
    for(let j=i+1;j<particles.length;j++){
      const dx=particles[i].x-particles[j].x,dy=particles[i].y-particles[j].y;
      const dist=Math.sqrt(dx*dx+dy*dy);
      if(dist<120){
        ctx.beginPath();
        ctx.moveTo(particles[i].x,particles[i].y);
        ctx.lineTo(particles[j].x,particles[j].y);
        ctx.strokeStyle=`rgba(255,59,59,${0.05*(1-dist/120)})`;
        ctx.lineWidth=0.5;
        ctx.stroke();
      }
    }
  }
}

function animateParticles(){
  ctx.clearRect(0,0,canvas.width,canvas.height);
  particles.forEach(p=>{p.update();p.draw()});
  drawConnections();
  requestAnimationFrame(animateParticles);
}
animateParticles();

// === CLOCK ===
function updateClock(){
  const n=new Date();
  document.getElementById('clock').textContent=n.toLocaleString('zh-TW',{timeZone:'Asia/Taipei',hour12:false,year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit',second:'2-digit'});
}
setInterval(updateClock,1000);updateClock();

// === LIVE LOG ===
const logEl=document.getElementById('liveLog');
const logMsgs=[
  ['info','System heartbeat check...'],['ok','NIM inference pipeline active'],['info','Supabase connection pool: 8/20'],
  ['ok','L1 constraint engine running'],['ok','L2 business rules loaded'],['ok','L3 safety monitor active'],
  ['warn','L4 boss override: ARMED'],['ok','Telegram bot heartbeat sent'],['info','Azure Functions: 3/3 running'],
  ['ok','Model slot rotation check'],['info','Patent 115100981 sovereignty verified'],['ok','CaaS architecture: ONLINE'],
  ['info','Particle system: 80 nodes active'],['ok','10/10 AI soldiers reporting'],['info','Cloudflare Workers: routing active'],
  ['ok','Key Vault secrets: valid'],['info','Data sync: Tokyo → East Asia'],['ok','Physical AI L1-L4: all layers active'],
  ['warn','Commander dashboard refresh'],['ok','Constraint pipeline throughput: nominal']
];
let logIdx=0;
function addLog(){
  const msg=logMsgs[logIdx%logMsgs.length];
  const now=new Date().toLocaleTimeString('zh-TW',{timeZone:'Asia/Taipei',hour12:false});
  const line=document.createElement('div');
  line.className='log-line';
  line.innerHTML=`<span class="log-time">${now}</span> <span class="log-${msg[0]}">[${msg[0].toUpperCase()}]</span> ${msg[1]}`;
  logEl.appendChild(line);
  if(logEl.children.length>20)logEl.removeChild(logEl.firstChild);
  logEl.scrollTop=logEl.scrollHeight;
  logIdx++;
}
setInterval(addLog,2000);addLog();

// === TICKER ===
function buildTicker(d){
  const items=[];
  if(d){
    const online=d.soldiers?d.soldiers.filter(s=>s.status==='ONLINE').length:0;
    items.push({c:'var(--green)',t:`MODELS ${online}/10`});
    items.push({c:'var(--blue)',t:`AZURE ${d.progress_detail?.azure_apps||'--'}`});
    items.push({c:'var(--green)',t:`SUPABASE ${d.progress_detail?.supabase||'--'}`});
    items.push({c:'var(--cyan)',t:`CLOUDFLARE ${d.progress_detail?.cloudflare||'--'}`});
    items.push({c:'var(--gold)',t:`PATENT 115100981`});
    items.push({c:'var(--purple)',t:`CaaS L1-L4 ACTIVE`});
    items.push({c:'var(--green)',t:`TELEGRAM ${d.telegram||'--'}`});
    items.push({c:'var(--red)',t:`COMMANDER 許竣翔`});
    (d.soldiers||[]).forEach(s=>{
      items.push({c:s.status==='ONLINE'?'var(--green)':'var(--red)',t:`${s.slot}: ${s.status} ${s.response_ms>0?s.response_ms+'ms':''}`});
    });
  }else{
    items.push({c:'var(--gold)',t:'LOADING SYSTEM DATA...'});
  }
  // Duplicate for seamless scroll
  const all=[...items,...items];
  document.getElementById('ticker').innerHTML=all.map(i=>`<span class="ticker-item"><span class="dot" style="background:${i.c}"></span>${i.t}</span>`).join('');
}
buildTicker(null);

// === DATA ===
async function load(){
  try{
    const r=await fetch(API);
    cachedData=await r.json();
    render(cachedData);
    buildTicker(cachedData);
  }catch(e){
    document.getElementById('content').innerHTML='<div class="loading"><div class="loading-text" style="color:var(--red)">CONNECTION LOST - RETRYING...</div></div>';
  }
}

function msColor(ms){
  if(ms<500)return 'var(--green)';if(ms<1500)return 'var(--gold)';if(ms<3000)return 'var(--orange)';return 'var(--red)';
}

function ringSVG(pct,color){
  const r=34,c=2*Math.PI*r,off=c*(1-pct/100);
  return `<svg width="80" height="80" viewBox="0 0 80 80"><circle class="bg" cx="40" cy="40" r="${r}"/><circle class="fg" cx="40" cy="40" r="${r}" stroke="${color}" stroke-dasharray="${c}" stroke-dashoffset="${off}" style="animation:ringDraw 1.5s ease-out"/></svg>`;
}

function switchView(v,el){
  currentView=v;
  document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
  if(el)el.classList.add('active');
  if(cachedData)render(cachedData);else load();
}

function render(d){
  const pct=parseInt(d.overall_progress)||0;
  const pbar=document.getElementById('pbar');
  pbar.style.width=pct+'%';
  if(pct>=90)pbar.style.background='linear-gradient(90deg,var(--green),#00c853)';
  else if(pct>=70)pbar.style.background='linear-gradient(90deg,var(--gold),var(--orange))';
  else pbar.style.background='linear-gradient(90deg,var(--red),#ff6b3b)';
  document.getElementById('pctVal').textContent=d.overall_progress;

  const slackers=Array.isArray(d.slackers)?d.slackers:[];
  const waste=Array.isArray(d.waste_alert)?d.waste_alert:[];
  const ab=document.getElementById('alertBanner');
  if(slackers.length||waste.length){
    ab.className='alert show';
    ab.innerHTML='WARNING: '+(slackers.length?slackers.length+' SLACKERS ':'')+(waste.length?waste.length+' WASTE ITEMS':'');
  }else{ab.className='alert'}

  if(currentView==='war')renderWar(d);
  else if(currentView==='physics')renderPhysics(d);
  else if(currentView==='models')renderModels(d);
  else if(currentView==='azure')renderAzure(d);
  else if(currentView==='meeting')renderMeeting(d);
  else if(currentView==='endpoints')renderEndpoints(d);
}

function renderWar(d){
  const online=d.soldiers?d.soldiers.filter(s=>s.status==='ONLINE').length:0;
  const apps=d.azure_apps?d.azure_apps.filter(a=>a.status==='RUNNING').length:0;
  const slackers=Array.isArray(d.slackers)?d.slackers:[];
  const waste=Array.isArray(d.waste_alert)?d.waste_alert:[];
  let h='<div class="main">';

  // Radar + Metrics
  h+=`<div class="card c-12" style="padding:24px">
    <div style="display:flex;align-items:center;justify-content:space-around;flex-wrap:wrap;gap:20px">
      <div class="radar-wrap">
        <svg class="radar-svg" viewBox="0 0 200 200">
          <circle cx="100" cy="100" r="80" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="1"/>
          <circle cx="100" cy="100" r="60" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="1"/>
          <circle cx="100" cy="100" r="40" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="1"/>
          <circle cx="100" cy="100" r="20" fill="none" stroke="rgba(255,255,255,0.03)" stroke-width="1"/>
          <line x1="100" y1="20" x2="100" y2="180" stroke="rgba(255,255,255,0.03)" stroke-width="1"/>
          <line x1="20" y1="100" x2="180" y2="100" stroke="rgba(255,255,255,0.03)" stroke-width="1"/>
          <path d="M100,100 L100,20 A80,80,0,0,1,156,44 Z" fill="rgba(0,230,118,0.08)" class="radar-sweep"/>
          ${(d.soldiers||[]).map((s,i)=>{
            const a=(i/10)*Math.PI*2-Math.PI/2;
            const r2=s.status==='ONLINE'?55+Math.random()*20:30;
            const x=100+Math.cos(a)*r2,y=100+Math.sin(a)*r2;
            return `<circle cx="${x}" cy="${y}" r="3" fill="${s.status==='ONLINE'?'var(--green)':'var(--red)'}" class="radar-dot" style="animation-delay:${i*0.3}s"/>`;
          }).join('')}
        </svg>
      </div>
      <div class="metrics-row" style="flex:1">
        <div><div class="metric-ring">${ringSVG(online*10,online>=10?'var(--green)':'var(--red)')}<div class="metric-num">${online}</div></div><div class="metric-label">AI MODELS</div></div>
        <div><div class="metric-ring">${ringSVG(apps/3*100,apps>=3?'var(--green)':'var(--red)')}<div class="metric-num">${apps}</div></div><div class="metric-label">AZURE</div></div>
        <div><div class="metric-ring">${ringSVG(d.progress_detail?.supabase==='connected'?100:0,d.progress_detail?.supabase==='connected'?'var(--green)':'var(--red)')}<div class="metric-num">${d.progress_detail?.supabase==='connected'?'OK':'!'}</div></div><div class="metric-label">SUPABASE</div></div>
        <div><div class="metric-ring">${ringSVG(d.telegram==='ONLINE'?100:0,'var(--cyan)')}<div class="metric-num">${d.telegram==='ONLINE'?'OK':'!'}</div></div><div class="metric-label">TELEGRAM</div></div>
      </div>
    </div>
  </div>`;

  // Overview + Orders
  h+=`<div class="card c-6"><div class="card-head"><span class="card-title">System Overview</span><span class="badge ${parseInt(d.overall_progress)>=90?'g':'r'}">${d.overall_progress}</span></div>
    <div class="stat-row"><span class="stat-label">AI Models</span><span class="stat-val ${d.progress_detail?.models==='10/10'?'g':'r'}">${d.progress_detail?.models}</span></div>
    <div class="stat-row"><span class="stat-label">Azure Functions</span><span class="stat-val ${d.progress_detail?.azure_apps==='3/3'?'g':'r'}">${d.progress_detail?.azure_apps}</span></div>
    <div class="stat-row"><span class="stat-label">Supabase</span><span class="stat-val ${d.progress_detail?.supabase==='connected'?'g':'r'}">${d.progress_detail?.supabase}</span></div>
    <div class="stat-row"><span class="stat-label">Cloudflare</span><span class="stat-val g">${d.progress_detail?.cloudflare}</span></div>
    <div class="stat-row"><span class="stat-label">Heartbeat</span><span class="stat-val g">${d.progress_detail?.heartbeat_timer}</span></div>
    <div class="stat-row"><span class="stat-label">Physical AI</span><span class="stat-val g">L1-L4 ACTIVE</span></div>
    <div class="stat-row"><span class="stat-label">Sovereignty</span><span class="stat-val g">${d.progress_detail?.sovereignty}</span></div>
  </div>`;

  h+=`<div class="card c-6 ${slackers.length||waste.length?'danger':'ok'}"><div class="card-head"><span class="card-title">Commander Orders</span><span class="badge ${slackers.length?'r':'g'}">${slackers.length?'ACTION':'ALL CLEAR'}</span></div>
    <div class="stat-row"><span class="stat-label">Dead Models</span><span class="stat-val ${slackers.length?'r':'g'}">${d.orders?.dead_models||'--'}</span></div>
    <div class="stat-row"><span class="stat-label">Slow Response</span><span class="stat-val ${d.orders?.slow_response!=='All fast'?'y':'g'}">${d.orders?.slow_response||'--'}</span></div>
    <div class="stat-row"><span class="stat-label">Cost Waste</span><span class="stat-val ${d.orders?.cost_waste!=='No waste'?'r':'g'}">${d.orders?.cost_waste||'--'}</span></div>
    <div class="stat-row"><span class="stat-label">Slackers</span><span class="stat-val ${slackers.length?'r':'g'}">${slackers.length?slackers.join(', '):'NONE'}</span></div>`;
  if(waste.length)waste.forEach(w=>{h+=`<div class="stat-row"><span class="stat-val r">${w.item}</span><span class="stat-val y">${w.action}</span></div>`});
  h+=`</div>`;

  // Soldiers
  h+=`<div class="card c-12"><div class="card-head"><span class="card-title">AI Soldiers</span><span class="badge g">${online}/10</span></div><div class="soldier-grid">`;
  (d.soldiers||[]).forEach(s=>{
    const dead=s.status==='DEAD';
    h+=`<div class="soldier ${dead?'dead':'online'}">
      <div class="s-top"><div><div class="s-name">${s.slot}</div><div class="s-model">${(s.model||'').split('/').pop()} | ${s.size}</div></div><span class="s-tag ${dead?'off':'on'}">${s.status}</span></div>
      <div class="s-bar"><div class="s-bar-fill" style="width:${Math.min((s.response_ms||0)/5000*100,100)}%;background:${msColor(s.response_ms)}"></div></div>
      <div class="s-meta"><span class="cost-${s.cost}">${s.cost}</span><span>${s.response_ms>0?s.response_ms+'ms':'--'}</span></div>
    </div>`;
  });
  h+=`</div></div>`;

  h+=`</div>`;
  document.getElementById('content').innerHTML=h;
}

function renderPhysics(d){
  let h='<div class="main">';
  h+=`<div class="pai-section">
    <div class="pai-head"><div class="pai-title">PHYSICAL AI — 世界定義約束法</div><span class="badge b">Patent 115100981</span></div>
    <p style="color:rgba(255,255,255,0.4);font-size:13px;margin-bottom:20px;line-height:1.6">Constraint-as-a-Service (CaaS)：透過 L1-L4 約束層，將物理世界法則、商業規則、安全邊界注入 AI 推理，實現可控、可驗證、可追溯的 AI 行為。</p>
    <div class="pai-grid">
      <div class="pai-card"><div class="pai-layer l1">L1</div><div class="pai-name">Physical Laws</div><div class="pai-desc">物理定律約束層<br>重力、能量守恆、因果律<br>不可違反的基礎物理法則</div><div class="pai-status live">ENFORCED</div></div>
      <div class="pai-card"><div class="pai-layer l2">L2</div><div class="pai-name">Business Rules</div><div class="pai-desc">商業規則約束層<br>價格邊界、庫存限制、合規要求<br>可配置的業務邏輯</div><div class="pai-status live">ACTIVE</div></div>
      <div class="pai-card"><div class="pai-layer l3">L3</div><div class="pai-name">Safety Bounds</div><div class="pai-desc">安全邊界約束層<br>輸出過濾、風險控制、異常檢測<br>即時安全保障</div><div class="pai-status live">MONITORING</div></div>
      <div class="pai-card"><div class="pai-layer l4">L4</div><div class="pai-name">Boss Override</div><div class="pai-desc">指揮官覆寫約束層<br>最高權限、緊急介入、策略調整<br>許竣翔 CEO 專屬</div><div class="pai-status live">ARMED</div></div>
    </div>
    <div class="constraint-flow" style="position:relative">
      <div class="flow-title">Inference Pipeline — Live Data Flow</div>
      <div class="flow-line">
        <span class="flow-node input">User Input</span><span class="flow-arrow">→</span>
        <span class="flow-node constraint">L1 Filter</span><span class="flow-arrow">→</span>
        <span class="flow-node constraint">L2 Validate</span><span class="flow-arrow">→</span>
        <span class="flow-node process">NIM Inference (10 Models)</span><span class="flow-arrow">→</span>
        <span class="flow-node constraint">L3 Safety</span><span class="flow-arrow">→</span>
        <span class="flow-node constraint">L4 Check</span><span class="flow-arrow">→</span>
        <span class="flow-node output">Response</span>
      </div>
    </div>
  </div>`;

  h+=`<div class="card c-6"><div class="card-head"><span class="card-title">CaaS Architecture</span><span class="badge b">LIVE</span></div>
    <div class="stat-row"><span class="stat-label">Constraint Engine</span><span class="stat-val g">seobaike-l1l4-pipeline</span></div>
    <div class="stat-row"><span class="stat-label">AI Router</span><span class="stat-val g">seobaike-ai-router</span></div>
    <div class="stat-row"><span class="stat-label">Model Slots</span><span class="stat-val w">10 NIM Models</span></div>
    <div class="stat-row"><span class="stat-label">Region</span><span class="stat-val w">East Asia + Tokyo</span></div>
    <div class="stat-row"><span class="stat-label">Architecture</span><span class="stat-val w">USB Plug/Unplug</span></div>
    <div class="stat-row"><span class="stat-label">Constraint Layers</span><span class="stat-val w">4 (L1-L4)</span></div>
  </div>`;

  h+=`<div class="card c-6"><div class="card-head"><span class="card-title">Physical AI Applications</span><span class="badge y">DEPLOYED</span></div>
    <div class="stat-row"><span class="stat-label">AI App Store</span><span class="stat-val g">14 Platforms</span></div>
    <div class="stat-row"><span class="stat-label">SEO AI</span><span class="stat-val g">Keyword + Content</span></div>
    <div class="stat-row"><span class="stat-label">Smart Retail</span><span class="stat-val g">即時定價 + 庫存</span></div>
    <div class="stat-row"><span class="stat-label">IoT Integration</span><span class="stat-val g">感測器 → AI → 行動</span></div>
    <div class="stat-row"><span class="stat-label">Autonomous Agent</span><span class="stat-val g">自主決策 + 約束</span></div>
    <div class="stat-row"><span class="stat-label">Safety Monitor</span><span class="stat-val g">異常偵測 + 即時告警</span></div>
  </div>`;

  h+=`</div>`;
  document.getElementById('content').innerHTML=h;
}

function renderModels(d){
  let h='<div class="main">';
  const online=d.soldiers?d.soldiers.filter(s=>s.status==='ONLINE').length:0;
  h+=`<div class="card c-12"><div class="card-head"><span class="card-title">AI Soldiers - Full Report</span><span class="badge ${online>=10?'g':'r'}">${online}/10</span></div><div class="soldier-grid">`;
  (d.soldiers||[]).forEach(s=>{
    const dead=s.status==='DEAD';
    h+=`<div class="soldier ${dead?'dead':'online'}">
      <div class="s-top"><div><div class="s-name">${s.slot}</div><div class="s-model">${(s.model||'').split('/').pop()}</div><div class="s-model">${s.size}</div></div><span class="s-tag ${dead?'off':'on'}">${s.status}</span></div>
      <div class="s-bar"><div class="s-bar-fill" style="width:${Math.min((s.response_ms||0)/5000*100,100)}%;background:${msColor(s.response_ms)}"></div></div>
      <div class="s-meta"><span class="cost-${s.cost}">${s.cost}</span><span>${s.response_ms>0?s.response_ms+'ms':'--'}</span></div>
      <div style="margin-top:6px;font-size:10px;color:rgba(255,255,255,0.2)">${s.slacking?'SLACKING':'WORKING'} | ${s.waste?'WASTE':'EFFICIENT'}</div>
    </div>`;
  });
  h+=`</div></div></div>`;
  document.getElementById('content').innerHTML=h;
}

function renderAzure(d){
  let h='<div class="main">';
  const apps=d.azure_apps||[];
  const running=apps.filter(a=>a.status==='RUNNING').length;
  h+=`<div class="card c-12"><div class="card-head"><span class="card-title">Azure Function Apps</span><span class="badge ${running>=3?'g':'r'}">${running}/3</span></div>`;
  apps.forEach(a=>{
    const on=a.status==='RUNNING';
    h+=`<div class="app-item"><div class="app-dot ${on?'on':'off'}"></div><span class="app-name">${a.name}</span><span class="app-ms" style="color:${msColor(a.response_ms)}">${a.response_ms>0?a.response_ms+'ms':'--'}</span><span class="app-cost">${a.cost}</span></div>`;
  });
  h+=`</div>`;
  h+=`<div class="card c-12"><div class="card-head"><span class="card-title">Supabase Heartbeats</span><span class="badge b">LIVE</span></div>`;
  (d.supabase_heartbeats||[]).forEach(hb=>{
    const t=hb.last_heartbeat?new Date(hb.last_heartbeat).toLocaleString('zh-TW',{timeZone:'Asia/Taipei',hour12:false}):'--';
    const ok=hb.status==='healthy';
    h+=`<div class="hb-item"><div class="hb-dot" style="background:${ok?'var(--green)':'var(--red)'}"></div><span class="hb-name">${hb.component}</span><span style="color:${ok?'var(--green)':'var(--red)'};font-size:11px">${hb.status}</span><span class="hb-time">${t}</span></div>`;
  });
  h+=`</div></div>`;
  document.getElementById('content').innerHTML=h;
}

function renderMeeting(d){
  document.getElementById('content').innerHTML=`<div class="main"><div class="card c-12">
    <div class="card-head"><span class="card-title">Department Meeting</span><span class="badge r">FORCE OUTPUT</span></div>
    <div class="meeting-box"><button class="meeting-btn" onclick="forceMeeting()">FORCE ALL DEPARTMENTS REPORT NOW</button><div class="meeting-result" id="meetingResult"></div></div>
  </div></div>`;
}

function renderEndpoints(d){
  const eps=[
    {n:'Commander',u:'https://grok-takeover-app.azurewebsites.net/api/commander'},
    {n:'Dashboard',u:'https://grok-takeover-app.azurewebsites.net/api/dashboard'},
    {n:'Alive Check',u:'https://grok-takeover-app.azurewebsites.net/api/alive_check'},
    {n:'AI Router',u:'https://seobaike-ai-router.azurewebsites.net/api/health'},
    {n:'AI Router Slots',u:'https://seobaike-ai-router.azurewebsites.net/api/slots'},
    {n:'L1L4 Pipeline',u:'https://seobaike-l1l4-pipeline.azurewebsites.net/api/health'},
    {n:'Cloudflare',u:'https://api.aiforseo.vip/api/health'},
    {n:'Supabase',u:'https://supabase.com/dashboard/project/vmyrivxxibqydccurxug'},
    {n:'War Room',u:'https://www.aiforseo.vip/commander'}
  ];
  let h='<div class="main"><div class="card c-12"><div class="card-head"><span class="card-title">All Endpoints</span><span class="badge b">'+eps.length+'</span></div>';
  eps.forEach(e=>{h+=`<div class="ep-item"><span class="ep-name">${e.n}</span><a href="${e.u}" target="_blank" class="ep-url">${e.u}</a></div>`});
  h+=`</div></div>`;
  document.getElementById('content').innerHTML=h;
}

async function forceMeeting(){
  const el=document.getElementById('meetingResult');
  el.textContent='Calling all departments...';
  try{
    const r=await fetch('https://seobaike-ai-router.azurewebsites.net/api/route',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({messages:[{role:'user',content:'全部門報到，各報告一句話狀態'}],provider:'gemma',max_tokens:200})});
    const d=await r.json();
    el.textContent=d.result?.content||JSON.stringify(d,null,2);
  }catch(e){el.textContent='Error: '+e.message}
}

load();
setInterval(load,15000);
</script>
</body>
</html>
